<!DOCTYPE html>
<html lang="en">
<head>
    <title>SQL Server Szybki trening 2</title>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width" />
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans:400,900&amp;subset=latin-ext" rel="stylesheet" />
    <!-- Shower Theme -->
    <link rel="stylesheet" href="vendors/shower-ribbon/styles/screen-16x9.css" />
    <link rel="stylesheet" href="vendors/shower-CezaryWalenciuk/styles/main.css" />
    <!-- Prism.js -->
    <link rel="stylesheet" href="vendors/prism/prism.css" />
    <link rel="stylesheet" href="vendors/prism/custom-prism.css" />
    <link rel="stylesheet" href="codegrid.css" />
</head>
<body class="shower list">
    <header class="caption">
        <h1>SQL Server Szybki trening 2</h1>
        <p></p>
    </header>

    <section class="slide front-page">

        <div class="details">
            <!-- 1. Avatar -->


            <h2>Cezary Walenciuk</h2>

            <!-- 3. Presentation title -->
            <h2 class="bigbig"><strong style="font-size: 35px;  line-height: 1.3;">

                    <span class="titlec1">SQL Server Szybki Trening 2</span>
                    <span class=""></span></strong></h2>



            <!-- 5. Contact the speaker -->
            <h2><a href="https://twitter.com/WalenciukC">@walenciukC</a></h2>
        </div>
        <div>


            <!-- 2. Speaker -->

        </div>
        <div class="imag">
            <img src="images/my-avatar.jpg" alt="Speaker">
        </div>
    </section>

    <section class="slide creamB smaller  compact ">
        <ol>
            <li class="next">Przypomienie</li>
            <li class="next">Zaawansowana Zapytania SELECT</li>
            <li class="next">Windows Function</li>
            <li class="next">Tranzakcje, Lock, Block i Deadlock</li>
            <li class="next">Daty, Liczby i stringi</li>
        </ol>
    </section>

    <section class="slide creamP">
        <span class="shout colors"><span>6. Zaawansowana Zapytania SELECT
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-0 Pobierz mi pierwsze 10 rekordów unikatowych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">
                        SELECT DISTINCT TOP (10) HireDate
                        FROM HumanResources.Employee
                        ORDER BY HireDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-0 Filtrowanie rezultatu z podzapytania</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 44px !important;">
                        SELECT s.PurchaseOrderNumber
                        FROM Sales.SalesOrderHeader s
                        WHERE EXISTS ( SELECT SalesOrderID
                        FROM Sales.SalesOrderDetail
                        WHERE UnitPrice BETWEEN 1900 AND 2000
                        AND SalesOrderID = s.SalesOrderID )
                        ORDER BY s.PurchaseOrderNumber;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-0-2 Filtrowanie rezultatu z podzapytania</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 44px !important;">
                        SELECT DISTINCT sh.PurchaseOrderNumber
                        FROM Sales.SalesOrderHeader AS sh
                        JOIN Sales.SalesOrderDetail AS sd
                        ON sh.SalesOrderID = sd.SalesOrderID
                        WHERE sd.UnitPrice BETWEEN 1900 AND 2000;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-0-3 Zwrócenie losowych wierszy z tabeli</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT FirstName,
                        LastName
                        FROM Person.Person
                        TABLESAMPLE SYSTEM (2 PERCENT);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-0<br /><span>Zapytania z gotowymi wynikami
        </span></span>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-0 Zapytania z gotowymi wynikami</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">

                        SELECT *
                        FROM (VALUES ('George', 'Washington'),
                        ('Thomas', 'Jefferson'),
                        ('John', 'Adams'),
                        ('James', 'Madison'),
                        ('James', 'Monroe'),
                        ('John Quincy', 'Adams'),
                        ('Andrew', 'Jackson'),
                        ('Martin', 'Van Buren'),
                        ('William', 'Harrison'),
                        ('John', 'Tyler')
                        ) dtPresidents(FirstName, LastName);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide creamB">
        <span class="shout colors">6-1<br /><span>Wyświetlenie danych ze zmiennych
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-1 Wyświetlenie danych ze zmiennych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        DECLARE @FirstHireDate DATE,
                        @LastHireDate DATE;
                        SELECT @FirstHireDate = MIN(HireDate),
                        @LastHireDate = MAX(HireDate)
                        FROM HumanResources.Employee;
                        SELECT @FirstHireDate AS FirstHireDate,
                        @LastHireDate AS LastHireDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/select-01.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-2<br /><span>Tworzenie nowej tabeli z wyniku zapytania
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-2 Tworzenie nowej tabeli z wyniku zapytania</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        IF OBJECT_ID('dbo.mySales') 
                        IS NOT NULL DROP TABLE dbo.mySales;

                        SELECT *
                        INTO dbo.mySales
                        FROM Sales.SalesOrderDetail
                        WHERE ModifiedDate = '2011-06-01T00:00:00.000';

                        SELECT COUNT(*) AS QtyOfRows
                        FROM dbo.mySales;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB   compact ">
        <h2>Limity</h2>
        <ol class="nonumbers">
            <li class="next">Nie możesz tworzyć nowych tabel w innej instancji serwera</li>
            <li class="next">Nie możesz tworzyć tak zmiennej tabeli</li>
            <li class="next">Tylko dane i columny są skopiowane. Indexy,Triggery,Klucze obce nie są skopiowane</li>
        </ol>
    </section>
    <section class="slide creamB   compact ">
        <h2>Limity</h2>
        <ol class="nonumbers">
            <li class="next">Użycie ORDER BY nie gwarantuje skopiowania w tej kolejności</li>
            <li class="next">Kolumna Computed nie będzie skopiowana jako taka kolumna</li>
        </ol>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-3<br /><span>Wysłanie rekordów do funkcji
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-3 Wysłanie rekordów do funkcji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 19px !important;">
                        IF OBJECT_ID('dbo.fn_WorkOrderRouting') IS NOT NULL DROP FUNCTION dbo.fn_WorkOrderRouting;
                        GO
                        CREATE FUNCTION dbo.fn_WorkOrderRouting (@WorkOrderID INT)
                            RETURNS TABLE
                            AS
                            RETURN
                            SELECT WorkOrderID,
                            ProductID,
                            OperationSequence,
                            LocationID
                            FROM Production.WorkOrderRouting
                            WHERE WorkOrderID = @WorkOrderID;
                        GO

                        SELECT TOP (5)
                        w.WorkOrderID,
                        w.OrderQty,
                        r.ProductID,
                        r.OperationSequence
                        FROM Production.WorkOrder w
                        CROSS APPLY dbo.fn_WorkOrderRouting(w.WorkOrderID) AS r
                        ORDER BY w.WorkOrderID,
                        w.OrderQty,
                        r.ProductID;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-3-1 Wysłanie rekordów do funkcji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 26px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 26px !important;">
                        INSERT INTO Production.WorkOrder
                            (ProductID,
                            OrderQty,
                            ScrappedQty,
                            StartDate,
                            EndDate,
                            DueDate,
                            ScrapReasonID,
                            ModifiedDate)
                        VALUES (1,
                        1,
                        1,
                        GETDATE(),
                        GETDATE(),
                        GETDATE(),
                        1,
                        GETDATE());
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-3-2 Wysłanie rekordów do funkcji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 26px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 29px !important;">
                        SELECT w.WorkOrderID,
                        w.OrderQty,
                        r.ProductID,
                        r.OperationSequence
                        FROM Production.WorkOrder AS w
                        CROSS APPLY dbo.fn_WorkOrderRouting(w.WorkOrderID) AS r
                        WHERE w.WorkOrderID IN (SELECT MAX(WorkOrderID)
                        FROM Production.WorkOrder);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-3-4 Wysłanie rekordów do funkcji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT w.WorkOrderID,
                        w.OrderQty,
                        r.ProductID,
                        r.OperationSequence
                        FROM Production.WorkOrder AS w
                        OUTER APPLY dbo.fn_WorkOrderRouting(w.WorkOrderID) AS r
                        WHERE w.WorkOrderID IN (SELECT MAX(WorkOrderID)
                        FROM Production.WorkOrder);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-3-5 Wysłanie rekordów do funkcji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 26px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 26px !important;">
                        SELECT TOP (5)
                        w.WorkOrderID,
                        w.OrderQty,
                        r.ProductID,
                        r.OperationSequence
                        FROM Production.WorkOrder w
                        CROSS APPLY (SELECT WorkOrderID,
                        ProductID,
                        OperationSequence,
                        LocationID
                        FROM Production.WorkOrderRouting
                        WHERE WorkOrderID = w.WorkOrderId
                        ) AS r
                        ORDER BY w.WorkOrderID,
                        w.OrderQty,
                        r.ProductID;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>


    <section class="slide creamB">
        <span class="shout colors">6-4<br /><span>Zmiana wierszy na kolumny
        </span></span>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_01-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-4 Zmiana wierszy na kolumny</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT s.Name AS ShiftName,
                        h.BusinessEntityID,
                        d.Name AS DepartmentName
                        FROM HumanResources.EmployeeDepartmentHistory h
                        INNER JOIN HumanResources.Department d
                        ON h.DepartmentID = d.DepartmentID
                        INNER JOIN HumanResources.Shift s
                        ON h.ShiftID = s.ShiftID
                        WHERE EndDate IS NULL
                        AND d.Name IN ('Production', 'Engineering', 'Marketing')
                        ORDER BY ShiftName;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_02-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-5<br /><span>Zmiana wierszy na kolumny
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-5-1 Zmiana wierszy na kolumny</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-sql">
                    <code style="line-height:19px !important;">
                        SELECT ShiftName,
                        Production,
                        Engineering,
                        Marketing
                        FROM 
                        
                        (   SELECT s.Name AS ShiftName,
                            h.BusinessEntityID,
                            d.Name AS DepartmentName
                            FROM HumanResources.EmployeeDepartmentHistory h
                            INNER JOIN HumanResources.Department d
                            ON h.DepartmentID = d.DepartmentID
                            INNER JOIN HumanResources.Shift s
                            ON h.ShiftID = s.ShiftID
                            WHERE EndDate IS NULL
                            AND d.Name IN ('Production', 'Engineering', 'Marketing')
                        ) 
                        
                        AS a
                        PIVOT
                        (
                            COUNT(BusinessEntityID)
                            FOR DepartmentName IN ([Production], [Engineering], [Marketing])
                        ) AS b
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-5-2 Zmiana wierszy na kolumny</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 50px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 50px !important;">
                        FROM table_source
                        PIVOT ( aggregate_function ( value_column )
                        FOR pivot_column
                        IN ( &#x3C;column_list&#x3E;)
                        ) table_alias
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB   compact ">
        <h2>Argumenty PIVOT</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">table_source :</span> źródło danych do sworzenia (pivoted) </li>
            <li class="next"><span class="green">aggregate_function :</span> Funkcja uzyta na poszczególnej kolumny</li>
            <li class="next"><span class="green">value_column :</span> Ta kolumna będzie użyta w agregacji</li>
        </ol>
    </section>
    <section class="slide creamB   compact ">
        <h2>Argumenty PIVOT</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">pivot_column :</span>Columny które będą użyte do utworzenia nagłówka </li>
            <li class="next"><span class="green">column_list :</span> Wartości dla sworzenia z kolumny</li>
            <li class="next"><span class="green">table_alias :</span> Alias w tabelce</li>
        </ol>
    </section>



    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-5-3 Zmiana wierszy na kolumny</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 31px !important;">
                        SELECT s.Name AS ShiftName,
                            SUM(CASE WHEN d.Name = 'Production' THEN 1 ELSE 0 END) AS Production,
                            SUM(CASE WHEN d.Name = 'Engineering' THEN 1 ELSE 0 END) AS Engineering,
                            SUM(CASE WHEN d.Name = 'Marketing' THEN 1 ELSE 0 END) AS Marketing
                        FROM HumanResources.EmployeeDepartmentHistory h
                        INNER JOIN HumanResources.Department d
                        ON h.DepartmentID = d.DepartmentID
                        INNER JOIN HumanResources.Shift s
                        ON h.ShiftID = s.ShiftID
                        WHERE h.EndDate IS NULL
                        AND d.Name IN ('Production', 'Engineering', 'Marketing')
                        GROUP BY s.Name;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-6<br /><span>Zmiana wierszy na kolumny
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-6 Zmiana kolumn na wiersze</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        IF OBJECT_ID('tempdb.dbo.#Contact') IS NOT NULL DROP TABLE #Contact;
                        CREATE TABLE #Contact
                        (
                            EmployeeID INT NOT NULL,
                            PhoneNumber1 BIGINT,
                            PhoneNumber2 BIGINT,
                            PhoneNumber3 BIGINT
                        )
                        GO

                        INSERT #Contact
                        (EmployeeID, PhoneNumber1, PhoneNumber2, PhoneNumber3)
                        VALUES (1, 2718353881, 3385531980, 5324571342),
                        (2, 6007163571, 6875099415, 7756620787),
                        (3, 9439250939, NULL, NULL);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-6-2 Zmiana kolumn na wiersze</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 41px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 50px !important;">
                        SELECT EmployeeID,
                            [PhoneNumber1],
                            [PhoneNumber2],
							[PhoneNumber3]
                        FROM #Contact c
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_03-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-6-3 Zmiana kolumn na wiersze</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT EmployeeID,
                            PhoneType,
                            PhoneValue
                            FROM #Contact c
                        UNPIVOT
                        (
                            PhoneValue
                            FOR PhoneType IN ([PhoneNumber1], [PhoneNumber2], 
                            [PhoneNumber3])
                        ) AS p;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_04-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-6-4 Zmiana kolumn na wiersze</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT EmployeeID,
                        'PhoneNumber1' AS PhoneType,
                        c.PhoneNumber1 AS PhoneValue
                        FROM #Contact c
                        WHERE c.PhoneNumber1 IS NOT NULL
                        UNION ALL
                        SELECT EmployeeID,
                        'PhoneNumber2' AS PhoneType,
                        c.PhoneNumber2 AS PhoneValue
                        FROM #Contact c
                        WHERE c.PhoneNumber2 IS NOT NULL
                        UNION ALL
                        SELECT EmployeeID,
                        'PhoneNumber3' AS PhoneType,
                        c.PhoneNumber3 AS PhoneValue
                        FROM #Contact c
                        WHERE c.PhoneNumber3 IS NOT NULL
                        ORDER BY EmployeeID, PhoneType;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-7<br /><span>Używanie zapytań ponownie
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-7 Używanie zapytań ponownie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 31px !important;">
                        WITH cte AS
                        (
                            SELECT SalesOrderID
                            FROM Sales.SalesOrderDetail
                            WHERE UnitPrice BETWEEN 1900 AND 2000
                        )

                        SELECT s.PurchaseOrderNumber
                        FROM Sales.SalesOrderHeader s
                        WHERE EXISTS (SELECT SalesOrderID
                        FROM cte
                        WHERE SalesOrderID = s.SalesOrderID );
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_05-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-7-1 Używanie zapytań ponownie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 50px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 50px !important;">
                        WITH expression_name
                        [ ( column_name [ ,...n ] ) ] 
                        AS ( CTE_query_SELECT_definition )
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>Argumenty CTE</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">expression_name :</span> Nazwa wyrażenia common table expression</li>
            <li class="next"><span class="green">column_name[(n,a)] :</span> Unikalne nazwy kolumn. Nie  muszę ich podawać</li>
            <li class="next"><span class="green">CTE_query_SELECT_definition :</span> Zapytanie SELECT, które definuje common table expression</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-7-2 Używanie zapytań ponownie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 39px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 39px !important;">
                        WITH CTE(N, D) AS
                        (
                            SELECT TOP (5) object_id, type_desc
                            FROM sys.objects
                        )
                        SELECT N,D FROM CTE;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>Mamy dwa typy CTE</h2>
        <ol class="nonumbers">
            <li class="next">Rekurecyjne</li>
            <li class="next">Nie rekurencyjne</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>CTE</h2>
        <ol class="nonumbers">
            <li class="next">Nie przechowuje rezultatu wywołania, kóre później może być wykorzystane ponownie</li>
        </ol>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-7-2 Używanie zapytań ponownie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 29px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 29px !important;">
                        WITH VendorSearch(RowNumber, VendorName, AccountNumber) AS
                        (
                            SELECT ROW_NUMBER() OVER (ORDER BY Name) RowNum,
                            Name,
                            AccountNumber
                            FROM Purchasing.Vendor
                        )

                        SELECT * FROM VendorSearch;
						SELECT * FROM VendorSearch;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-8<br /><span>Zapytania na tabelkach rekurecyjnych
        </span></span>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-8-1 Zapytania na tabelkach rekurecyjnych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        IF OBJECT_ID('tempdb.dbo.#Company') IS NOT NULL DROP TABLE #Company;
                        CREATE TABLE #Company
                        (
                            CompanyID INT NOT NULL
                            PRIMARY KEY,
                            ParentCompany ID INT NULL,
                            CompanyName VARCHAR(25) NOT NULL
                        );

                        INSERT #Company
                        (CompanyID, ParentCompanyID, CompanyName)
                        VALUES (1, NULL, 'A-Corp'),
                        (2, 1, 'B-Corp'),
                        (3, 1, 'C-Corp'),
                        (4, 3, 'D-Corp'),
                        (5, 4, 'F-Corp'),
                        (6, 5, 'E-Corp'),
                        (7, 5, 'G-Corp');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_06-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-8-2 Zapytania na tabelkach rekurecyjnych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 18px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 17px !important;">
                        WITH CompanyTree(ParentCompanyID, CompanyID, CompanyName, CompanyLevel) AS
                        (
                            -- Anchor Member
                            SELECT ParentCompanyID,
                            CompanyID,
                            CompanyName,
                            0 AS CompanyLevel
                            FROM #Company
                            WHERE ParentCompanyID IS NULL
                            UNION ALL
                            -- Recursive Member
                            SELECT c.ParentCompanyID,
                            c.CompanyID,
                            c.CompanyName,
                            p.CompanyLevel + 1
                            FROM #Company c
                            INNER JOIN CompanyTree p
                            ON c.ParentCompanyID = p.CompanyID
                        )

                        SELECT ParentCompanyID,
                        CompanyID,
                        CompanyName,
                        CompanyLevel
                        FROM CompanyTree;
                        option (maxrecursion 5)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>Mamy dwa typy CTE</h2>
        <ol class="nonumbers">
            <li class="next">Głębia rekursji wynosi maksymalnie 100</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-6-3 Zapytania na tabelkach rekurecyjnych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 41px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT ParentCompanyID,
                        CompanyID,
                        CompanyName,
                        CompanyLevel
                        FROM CompanyTree
                        option (MaxRecursion  5)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
 
    <section class="slide creamP">
        <span class="shout colors"><span>7. Window function i słowo kluczowe OVER
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors " style="font-size: 190% !important;"><span>Window Function pozwala twojemu zapytaniu SQL spojrzeć na podzbiór wierszy,
            które są zwracane przez zapytanie zanim funkcja agregująca zadziała na te wiersze
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle">
                <h2 class="headerCODE">5-2 Grupowanie podstawy z groupby</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT AVG(Grade) AS AvgGrade,
                        AVG(DISTINCT Grade) AS AvgDistinctGrade,
                        MAX(Grade) AS MaxGrade,
                        MIN(Grade) AS MinGrade
                        FROM (VALUES (1, 100),
                        (1, 99),
                        (1, 99),
                        (1, 98),
                        (1, 99),
                        (1, 32),
                        (2, 77),
                        (2, 56),
                        (2, 88),
                        (2, 60),
                        (2, 80)
                        ) dt (StudentId, Grade)
            
                        GROUP BY StudentId
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>

    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-01.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle">
                <h2 class="headerCODE">7-0-0 Grupowanie podstawy z groupby</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT 
                        StudentId,Grade
                        FROM (VALUES (1, 100),
                       (1, 99),
                       (1, 99),
                       (1, 98),
                       (1, 99),
                       (1, 32),
                       (2, 77),
                       (2, 56),
                       (2, 88),
                       (2, 60),
                       (2, 80)
                       ) dt (StudentId, Grade)
                                   
                       GROUP BY StudentId
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle">
                <h2 class="headerCODE">7-0-0 Grupowanie podstawy z groupby</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT 
                        StudentId,
                        AVG(Grade) OVER (ORDER BY StudentId) 
                        FROM (VALUES (1, 100),
                        (1, 99),
                        (1, 99),
                        (1, 98),
                        (1, 99),
                        (1, 32),
                        (2, 77),
                        (2, 22),
                        (2, 88),
                        (2, 60),
                        (2, 80)
                        ) dt (StudentId, Grade)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-03.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle">
                <h2 class="headerCODE">7-0-0 Grupowanie podstawy z groupby</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT 
                        StudentId,
                        AVG(Grade) OVER (ORDER BY StudentId) 
                        FROM (VALUES (11, 100),
                        (1, 99),
                        (2, 99),
                        (3, 98),
                        (4, 99),
                        (5, 32),
                        (6, 77),
                        (7, 22),
                        (8, 88),
                        (9, 60),
                        (10, 80)
                        ) dt (StudentId, Grade)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-04.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors " style="font-size: 190% !important;"><span>Window Function pozwala twojemu zapytaniu SQL spojrzeć na podzbiór wierszy,
            które są zwracane przez zapytanie zanim funkcja agregująca zadziała na te wiersze
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"  style="font-size: 190% !important;"><span>W ten sposób funkcje pozwalają tobie określeć odpowiednią kolejność danych, które mają trafić do pewnej operacji<span>
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-0 PRZYKŁAD</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 40px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT duration_seconds,
                        SUM(duration_seconds) OVER 
                        (ORDER BY start_time) 
                        AS running_total
                        FROM dc_bikeshare_q1_2012
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Lepsze to niż : self-join czy iterację po pętli
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"  style="font-size: 190% !important;"><span>Czyli Windows Function pozwala tobie kontrolować kolejność danych które mają trafić do funkcji agregującej
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Jakie funkcje agregujące mogą być wykonane ze słowem OVER</h2>
        <ol class="nonumbers">
            <li class="next">AVG, CHECKSUM-AGG, COUNT, COUNT_BIG, MAX, MIN,</li>
            <li class="next">STDEV, STDEVP, SUM, VAR, VARP</li>
        </ol>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Są jeszcze funkcje rankingowe
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next">ROW_NUMBER, RANK</li>
            <li class="next">DENSE_RANK, NTILE</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle">
                <h2 class="headerCODE">7-0-0 Grupowanie podstawy z groupby</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT 
                        StudentId,
                        RANK()  OVER (ORDER BY Grade) AS RANK,
                        DENSE_RANK() OVER (ORDER BY Grade) AS DENSE_RANK,
                        ROW_NUMBER() OVER (ORDER BY Grade) AS ROW_NUMBER,
                        AVG(Grade) OVER (ORDER BY Grade) AS AVGGrade
                        FROM (VALUES (11, 100),
                        (1, 99),
                        (2, 99),
                        (3, 98),
                        (4, 99),
                        (5, 32),
                        (6, 77),
                        (7, 22),
                        (8, 88),
                        (9, 60),
                        (10, 80)
                        ) dt (StudentId, Grade)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-05.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB  compact">
        <h2>Funkcje analityczne, a Offset functions</h2>
        <ol class="nonumbers">
            <li class="next">LAG, LEAD</li>
            <li class="next">FIRST_VALUE, i LAST_VALUE</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle">
                <h2 class="headerCODE">5-2 Grupowanie podstawy z groupby</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT 
                        StudentId,
                        LAG(Grade,1)  OVER (ORDER BY Grade) AS PreviousGrade,
                        LEAD(Grade,1) OVER (ORDER BY Grade) AS NextGrade,
                        FIRST_VALUE(Grade) OVER (ORDER BY Grade) AS FirstGrade,
                        LAST_VALUE(Grade)  OVER (ORDER BY Grade) AS LastGrade
                        FROM (VALUES (11, 100),
                        (1, 99),
                        (2, 99),
                        (3, 98),
                        (4, 99),
                        (5, 32),
                        (6, 77),
                        (7, 22),
                        (8, 88),
                        (9, 60),
                        (10, 80)
                        ) dt (StudentId, Grade)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>

    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-06.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-1<br /><span>Kalkulacje na podstawie kolejności wierszy
        </span></span>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-1 Kalkulacje na podstawie kolejności wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 21px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 21px !important;">

                        CREATE TABLE #Transactions
                        (
                            AccountId INTEGER,
                            TranDate DATE,
                            TranAmt NUMERIC(8, 2)
                        );
                        INSERT INTO #Transactions
                        SELECT *
                        FROM ( VALUES 
                        ( 1, '2011-01-01', 500),
                        ( 1, '2011-01-15', 50),
                        ( 1, '2011-01-22', 250),
                        ( 1, '2011-01-24', 75),
                        ( 1, '2011-01-26', 125),
                        ( 1, '2011-01-26', 175),
                        ( 2, '2011-01-01', 500),
                        ( 2, '2011-01-15', 50),
                        ( 2, '2011-01-22', 25),
                        ( 3, '2011-01-22', 5000),
                        ( 3, '2011-01-27', 550),
                        ( 3, '2011-01-27', 95 ),
                        ( 3, '2011-01-30', 2500)
                        ) dt (AccountId, TranDate, TranAmt);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-1-1 Kalkulacje na podstawie kolejności wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,
                        -- running total of all transactions
                        RunTotalAmt = SUM(TranAmt) 
                        OVER (PARTITION BY AccountId ORDER BY TranDate)
                        FROM #Transactions AS t
                        ORDER BY AccountId,
                        TranDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_08-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-1-2 Kalkulacje na podstawie kolejności wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,
                        -- running total of all transactions
                        RunTotalAmt = SUM(TranAmt) 
                        OVER (ORDER BY TranDate)
                        FROM #Transactions AS t
                        ORDER BY AccountId,
                        TranDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-067.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-1-3 Kalkulacje na podstawie kolejności wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,
                        -- running total of all transactions
                        RunTotalAmt = SUM(TranAmt) 
                        OVER (ORDER BY TranDate)
                        FROM #Transactions AS t
                        ORDER BY 
                        RunTotalAmt;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-07.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-1-3 Kalkulacje na podstawie kolejności wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,
                        -- running total of all transactions
                        RunTotalAmt = SUM(TranAmt) OVER (PARTITION BY AccountId ORDER BY TranDate),
                        -- "Proper" running total by row position
                        RunTotalAmt2 = SUM(TranAmt) OVER (PARTITION BY AccountId
                        ORDER BY TranDate
                        ROWS UNBOUNDED PRECEDING)
                        FROM #Transactions AS t
                        ORDER BY AccountId,
                        TranDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-1-4 Przykład</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        OVER (
                            [ &#x3C;PARTITION BY clause&#x3E; ]
                            [ &#x3C;ORDER BY clause&#x3E; ]
                            [ &#x3C;ROW or RANGE clause&#x3E; ]
                        )
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-08.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-1-3 Kalkulacje na podstawie kolejności wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 21px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 20px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,
        
                        RunAvg = AVG(TranAmt) OVER (PARTITION BY AccountId ORDER BY TranDate),
                      
                        RunTranQty = COUNT(*) OVER (PARTITION BY AccountId ORDER BY TranDate),
              
                        RunSmallAmt = MIN(TranAmt) OVER (PARTITION BY AccountId ORDER BY TranDate),
            
                        RunLargeAmt = MAX(TranAmt) OVER (PARTITION BY AccountId ORDER BY TranDate),
          
                        RunTotalAmt = SUM(TranAmt) OVER (PARTITION BY AccountId ORDER BY TranDate)

                        FROM #Transactions AS t
                        WHERE AccountID = 1
                        ORDER BY AccountId, TranDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-09.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-2<br /><span>Kalkulacje na obecnym wierszu i dwówch poprzednich
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-2-0 Przykład</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        OVER (
                            [ &#x3C;PARTITION BY clause&#x3E; ]
                            [ &#x3C;ORDER BY clause&#x3E; ]
                            [ &#x3C;ROW or RANGE clause&#x3E; ]
                        )
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-2 Kalkulacje na obecnym wierszu i dwówch poprzednich</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,

                        -- total # of the current and previous 2 transactions
                        SlideQty = COUNT(*)
                        OVER (PARTITION BY AccountId
                        ORDER BY TranDate
                        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW),

                        -- total of the current and previous 2 transactions
                        SlideTotal = SUM(TranAmt)
                        OVER (PARTITION BY AccountId
                        ORDER BY TranDate
                        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW)

                        FROM #Transactions AS t
                        ORDER BY AccountId, TranDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-10.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>

    <section class="slide creamB">
        <span class="shout colors">7-3<br /><span>Kalkulacje na podstawie procentu całości
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-3 Kalkulacje na podstawie procentu całości</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 38px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 38px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,

                        AccountTotal = SUM(TranAmt) 
                        OVER (PARTITION BY AccountId),

                        AmountPct = TranAmt / SUM(TranAmt) 
                        OVER (PARTITION BY t.AccountId)

                        FROM #Transactions AS t
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_10-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-4<br /><span>Kalkulacje na X-obecny wierszy i Y-wszystkich wierszy
        </span></span>
    </section>


    <section class="slide creamB  compact">
        <h2>Ranking functions : Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">ROW_NUMBER:</span> Zwraca liczbę całkowitą która rośnie wraz z liczbą wierszy. Zaczynajac od 1</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-4 Kalkulacje na X-obecny wierszy i Y-wszystkich wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 20px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 30px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,
                        KolejnyWierszPoId = ROW_NUMBER() OVER (PARTITION BY AccountId ORDER BY AccountId, TranDate),
                        KolejnyWierszPoWszystkich = COUNT(*) OVER (PARTITION BY AccountId),
                        IdWiersza = ROW_NUMBER() OVER (ORDER BY AccountId, TranDate),
                        WszystkieWiersze = COUNT(*) OVER ()
                        FROM #Transactions AS t
                        ORDER BY AccountId, TranDate;;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_11-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-6<br /><span>Generowanie kolumny z liczbą wierszy
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-6 Generowanie kolumny z liczbą wierszy </h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT TOP 10
                        AccountNumber,
                        OrderDate,
                        TotalDue,

                        ROW_NUMBER() OVER 
                        (PARTITION BY AccountNumber ORDER BY OrderDate) 
                        AS RowNumber

                        FROM AdventureWorks2014.Sales.SalesOrderHeader
                        ORDER BY AccountNumber;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_12-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-6<br /><span>Użycie logicznego Okna
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-7 Użycie logicznego Okna</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 26px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 26x !important;">

                        CREATE TABLE #Test
                        (
                            RowID INT IDENTITY,
                            FName VARCHAR(20),
                            Salary SMALLINT
                        );
                        INSERT INTO #Test (FName, Salary)
                        VALUES ('Adam', 800),
                        ('Stefan', 950),
                        ('Nosal', 1250),
                        ('Kalina', 1250), --<< powtórzenie
                        ('Patrycja', 1300),
                        ('Bartek', 1500),
                        ('Tomek', 1600),
                        ('Franek', 3000),
                        ('Cezary', 3000), --<< powtórzenie
                        ('Cezaryna', 5000);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>Framing options</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">ROWS :</span> od wierszy</li>
            <li class="next"><span class="green">RANGE :</span> od zakresu wartości</li>
            <li class="next"><span class="green">UNBOUNDED PRECEDING :</span> i nie wiążemy ich</li>
        </ol>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-7-1 Użycie logicznego Okna</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 29px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 29px !important;">
                        SELECT RowID,
                        FName,
                        Salary,
                        SumByRows = SUM(Salary) 
                        OVER (ORDER BY Salary ROWS UNBOUNDED PRECEDING),
                        SumByRange = SUM(Salary) 
                        OVER (ORDER BY Salary RANGE UNBOUNDED PRECEDING)
                        FROM #Test
                        ORDER BY RowID;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-11.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-8<br /><span>Zwracanie wierszy poprzez ich range
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Ranking functions : Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">RANK :</span> Podobne do Row_NUMBER() jednakże jeżeli napotkamy taką samą wartość w partycji to wartość pozostaje taka sama. 
                Jednakże następna wartość będzie już zinkremetowana po powtarzalnych wartościach
            </li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Ranking functions : Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">DENSE_RANK :</span> Podobne do Row_NUMBER() jednakże jeżeli napotkamy taką samą wartość w partycji to wartość pozostaje taka sama. 
                Jednakże następna wartość będzie już zinkremetowana</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Ranking functions : Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">NTILE :</span> NTILE dzieli rezultat na spefyciczne ponumerowane grupy bazujące na kolejności opcjonalnego wyrażenia ORDER</li>
        </ol>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-8 Zwracanie wierszy poprzez ich range </h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 26px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT BusinessEntityID,
                        SalesQuota,
                        RANK() OVER (ORDER BY SalesQuota DESC) AS RankWithGaps,
                        DENSE_RANK() OVER (ORDER BY SalesQuota DESC) AS RankWithoutGaps,
                        ROW_NUMBER() OVER (ORDER BY SalesQuota DESC) AS RowNumber
                        FROM Sales.SalesPersonQuotaHistory
                        WHERE QuotaDate = '2014-03-01'
                        AND SalesQuota < 500000;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-12.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-8<br /><span>Sortowanie rekordów do podgrup : podziel sprzedaże na 4 grupy
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Ranking functions : Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">NTILE :</span> NTILE dzieli rezultat na spefyciczne ponumerowane grupy bazujące na kolejności opcjonalnego wyrażenia ORDER</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Ranking functions : Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">NTILE :</span> czyli służy do podziału elementów na n-tyle (np. NTILE(4) = kwartyle ).</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-8 Sortowanie rekordów do podgrup : podziel sprzedaże na 4 grupy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT BusinessEntityID,
                        QuotaDate,
                        SalesQuota,
                        NTILE(4) OVER (ORDER BY SalesQuota DESC) AS [NTILE]
                        FROM Sales.SalesPersonQuotaHistory
                        WHERE SalesQuota BETWEEN 266000.00 AND 319000.00;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_15-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-8-1 Sortowanie rekordów do podgrup : podziel sprzedaże na 4 grupy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 29px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,
						NTILE(4) OVER (ORDER BY TranAmt DESC) AS [NTILE]
                        FROM #Transactions AS t
                        ORDER BY [NTILE],
                        TranDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-14.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-9<br /><span>Znajdowanie luk
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Funkcje analityczne, a Offset functions</h2>
        <ol class="nonumbers">
            <li class="next">LAG, LEAD</li>
            <li class="next">FIRST_VALUE, i LAST_VALUE</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Analytic functions : Funkcje analityczne</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">LEAD :</span> Pobiera dane z kolejnego wiersza </li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-9 Znajdowanie luk</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 20px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 20px !important;">
                        CREATE TABLE #Gaps (col1 INTEGER PRIMARY KEY CLUSTERED);

                        INSERT INTO #Gaps (col1)
                        VALUES (1), (2), (3),
                        (50), (51), (52), (53), (54), (55),
                        (100), (101), (102),
                        (500),
                        (950), (951), (952),
                        (954);

                        WITH cte AS
                        (
                            SELECT col1 AS CurrentRow,
                            LEAD(col1, 1, NULL) OVER (ORDER BY col1) AS NextRow
                            FROM #Gaps
                        )

                        -- Compare the value of the current row to the next row.
                        -- If > 1, then there is a gap.
                        SELECT cte.CurrentRow + 1 AS [Start of Gap],
                        cte.NextRow - 1 AS [End of Gap]
                        FROM cte
                        WHERE cte.NextRow - cte.CurrentRow > 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>


    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_16-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-10<br /><span>Porównanie danych z poprzedniego miesiąca
        </span></span>
    </section>

    <section class="slide creamB  compact">
        <h2>Analytic functions : Funkcje analityczne</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">LAG :</span> Pobiera danych w poprzedniego wiersza </li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-10 Lag example</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 21px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 20px !important;">
                        WITH cte_netsales_2018 AS(
                            SELECT 
                                month, 
                                SUM(net_sales) net_sales
                            FROM 
                                sales.vw_netsales_brands
                            WHERE 
                                year = 2018
                            GROUP BY 
                                month
                        )

                        SELECT 
                            month,
                            net_sales,
                            LAG(net_sales,1) OVER (
                                ORDER BY month
                            ) previous_month_sales
                        FROM 
                            cte_netsales_2018;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide creamB">
        <span class="shout colors">7-11<br /><span>Pobieranie pierwszej i ostatniej wartośći z partycji
        </span></span>
    </section>

    <section class="slide creamB  compact">
        <h2>Analytic functions : Funkcje analityczne</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">FIRST_VALUE :</span> Pobiera dane z pierwszego wiersza </li>
            <li class="next"><span class="green">LAST_VALUE :</span> Pobiera dane z ostatniego wiersza </li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-11 Pobieranie pierwszej i ostatniej wartośći z partycji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 22px !important;">
                        SELECT DISTINCT TOP (5)
                        CustomerID,
                        -- Get the date for the customer's least expensive order
                        FIRST_VALUE(OrderDate)
                        OVER (PARTITION BY CustomerID
                        ORDER BY TotalDue
                        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS OrderDateLow,
                        -- Get the date for the customer's most expensive order
                        LAST_VALUE(OrderDate)
                        OVER (PARTITION BY CustomerID
                        ORDER BY TotalDue
                        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS OrderDateHigh
                        FROM Sales.SalesOrderHeader
                        ORDER BY CustomerID;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-15.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>

    <!-- <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-9 Grupowanie logiczne kolejne wiersze razem</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 15px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 16px !important;">
                        CREATE TABLE #RFID_Location (
                            TagId INTEGER,
                            Location VARCHAR(25),
                            SensorReadTime DATETIME);
                            INSERT INTO #RFID_Location
                            (TagId, Location, SensorReadTime)
                            VALUES (1, 'Room1', '2012-01-10T08:00:01'),
                            (1, 'Room1', '2012-01-10T08:18:32'),
                            (1, 'Room2', '2012-01-10T08:25:42'),
                            (1, 'Room3', '2012-01-10T09:52:48'),
                            (1, 'Room2', '2012-01-10T10:05:22'),
                            (1, 'Room3', '2012-01-10T11:22:15'),
                            (1, 'Room4', '2012-01-10T14:18:58'),
                            (2, 'Room1', '2012-01-10T08:32:18'),
                            (2, 'Room1', '2012-01-10T08:51:53'),
                            (2, 'Room2', '2012-01-10T09:22:09'),
                            (2, 'Room1', '2012-01-10T09:42:17'),
                            (2, 'Room1', '2012-01-10T09:59:16'),
                            (2, 'Room2', '2012-01-10T10:35:18'),
                            (2, 'Room3', '2012-01-10T11:18:42'),
                            (2, 'Room4', '2012-01-10T15:22:18');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-9 Grupowanie logiczne kolejne wiersze razem</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 20px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 21px !important;">
                        WITH cte AS
                        (
                            SELECT TagId, Location, SensorReadTime,
                            ROW_NUMBER() OVER (PARTITION BY TagId ORDER BY SensorReadTime) -
                            ROW_NUMBER() OVER (PARTITION BY TagId, Location ORDER BY SensorReadTime) AS Grp
                            FROM #RFID_Location
                        )
                        SELECT TagId, Location, SensorReadTime, Grp,
                        DENSE_RANK() OVER (PARTITION BY TagId, Location ORDER BY Grp) AS TripNbr
                        FROM cte
                        ORDER BY TagId, SensorReadTime;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section> -->

    <!-- <section class="slide creamB  compact">
        <h2>Analytic functions : Funkcje analityczne</h2>
        <ol class="nonumbers">
            <li class="next">CUME_DIST : </li>
            <li class="next">FIRST_VALUE</li>
            <li class="next">LAG</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Analytic functions : Funkcje analityczne</h2>
        <ol class="nonumbers">
            <li class="next">LAST_VALUE</li>
            <li class="next">LEAD</li>
            <li class="next">PERCENTILE_CONT</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Analytic functions : Funkcje analityczne</h2>
        <ol class="nonumbers">
            <li class="next">PERCENTILE_DISC</li>
            <li class="next">PERCENT_RANK</li>
        </ol>
    </section> -->


<!-- 

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-10 Uzyskanie dostępu do innych wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 23px !important;">
                        WITH cte AS
                        (
                        -- Break the OrderDate down into the Year and Quarter
                        SELECT DATEPART(QUARTER, OrderDate) AS Qtr,
                        DATEPART(YEAR, OrderDate) AS Yr,
                        TotalDue
                        FROM Sales.SalesOrderHeader
                        ), cteAgg AS
                        (
                        -- Aggregate the TotalDue, Grouping on Year and Quarter
                        SELECT Yr,
                        Qtr,
                        SUM(TotalDue) AS TotalDue
                        FROM cte
                        GROUP BY Yr, Qtr
                        )
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-11 Znajdowanie pustych wartości w sekwencjach liczbowych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 23px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        CREATE TABLE #Gaps (col1 INTEGER PRIMARY KEY CLUSTERED);
                        INSERT INTO #Gaps (col1)
                        VALUES (1), (2), (3),
                        (50), (51), (52), (53), (54), (55),
                        (100), (101), (102),
                        (500),
                        (950), (951), (952),
                        (954);
                        -- Compare the value of the current row to the next row.
                        -- If > 1, then there is a gap.
                        WITH cte AS
                        (
                        SELECT col1 AS CurrentRow,
                        LEAD(col1, 1, NULL) OVER (ORDER BY col1) AS NextRow
                        FROM #Gaps
                        )
                        SELECT cte.CurrentRow + 1 AS [Start of Gap],
                        cte.NextRow - 1 AS [End of Gap]
                        FROM cte
                        WHERE cte.NextRow - cte.CurrentRow > 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-12-2 Poibieranie pierwszej i ostatniej wartośći z partycji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT CustomerID, TotalDue, OrderDate
                        FROM Sales.SalesOrderHeader
                        WHERE CustomerID = 11000
                        ORDER BY TotalDue;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-13 Kalkulowanie relatywnej pozycji lub rankingu  wartości wewnątrz zbioru wartości</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT CustomerID,
                        TotalDue,
                        CUME_DIST()
                        OVER (PARTITION BY CustomerID
                        ORDER BY TotalDue) AS CumeDistOrderTotalDue,
                        PERCENT_RANK()
                        OVER (PARTITION BY CustomerID
                        ORDER BY TotalDue) AS PercentRankOrderTotalDue
                        FROM Sales.SalesOrderHeader
                        WHERE CustomerID IN (11439, 30116)
                        ORDER BY CustomerID, TotalDue;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-14 Kalkulowanie relatywnej pozytcji lub rankingu  wartości wewnątrz zbioru wartości</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        DECLARE @Employees TABLE
                        (
                            EmplId INT PRIMARY KEY CLUSTERED,
                            DeptId INT,
                            Salary NUMERIC(8, 2)
                        );
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-14 Kalkulowanie relatywnej pozytcji lub rankingu  wartości wewnątrz zbioru wartości</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        INSERT INTO @Employees
                        VALUES (1, 1, 10000),
                        (2, 1, 11000),
                        (3, 1, 12000),
                        (4, 2, 25000),
                        (5, 2, 35000),
                        (6, 2, 75000),
                        (7, 2, 100000);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-14 Kalkulowanie relatywnej pozytcji lub rankingu  wartości wewnątrz zbioru wartości</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 22px !important;">
                        SELECT EmplId,
                        DeptId,
                        Salary,
                        PERCENTILE_CONT(0.5)
                        WITHIN GROUP (ORDER BY Salary ASC)
                        OVER (PARTITION BY DeptId) AS MedianCont,
                        PERCENTILE_DISC(0.5)
                        WITHIN GROUP (ORDER BY Salary ASC)
                        OVER (PARTITION BY DeptId) AS MedianDisc,
                        PERCENTILE_CONT(0.75)
                        WITHIN GROUP (ORDER BY Salary ASC)
                        OVER (PARTITION BY DeptId) AS Percent75Cont,
                        PERCENTILE_DISC(0.75)
                        WITHIN GROUP (ORDER BY Salary ASC)
                        OVER (PARTITION BY DeptId) AS Percent75Disc,
                        CUME_DIST()
                        OVER (PARTITION BY DeptId
                        ORDER BY Salary) AS CumeDist
                        FROM @Employees
                        ORDER BY DeptId, EmplId;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-15 Przypisywanie sekwencji do specyficznej kolejności</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 22px !important;">
                        IF EXISTS (SELECT *
                        FROM sys.sequences AS seq
                        JOIN sys.schemas AS sch
                        ON seq.schema_id = sch.schema_id
                        WHERE sch.name = 'dbo'
                        AND seq.name = 'CH7Sequence')
                        DROP SEQUENCE dbo.CH7Sequence;
                        CREATE SEQUENCE dbo.CH7Sequence AS INTEGER START WITH 1;
                        DECLARE @ClassRank TABLE
                        (
                        StudentID TINYINT,
                        Grade TINYINT,
                        SeqNbr INTEGER
                        );
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-15 Przypisywanie sekwencji do specyficznej kolejności</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 22px !important;">
                        INSERT INTO @ClassRank (StudentId, Grade, SeqNbr)
                        SELECT StudentId,
                        Grade,
                        NEXT VALUE FOR dbo.CH7Sequence OVER (ORDER BY Grade ASC)
                        FROM (VALUES (1, 100),
                        (2, 95),
                        (3, 85),
                        (4, 100),
                        (5, 99),
                        (6, 98),
                        (7, 95),
                        (8, 90),
                        (9, 89),
                        (10, 89),
                        (11, 85),
                        (12, 82)) dt(StudentId, Grade);
                        SELECT StudentId, Grade, SeqNbr
                        FROM @ClassRank;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section> -->

    <section class="slide creamB">
        <span class="shout colors"><span>8. Transakcje, Blokady i DeadLocki
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Transakcje</h2>
        <ol class="nonumbers">
            <li class="next">Atomicity : Transakcje działają na zasadzie wszystko, albo nic</li>
            <li class="next">Consistency : Dane są prawidłowe przed i po transakcji</li>
            <li class="next">Isolation : Transakcja nie jest zależna od innych transakcji</li>
            <li class="next">Durability : Zmiana po zatwierdzeniu działa</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Swoją drogą  istnieje możliwość włączenia 
            NIEJAWNYCH transakcji dla poleceń</h2>
        <ol class="nonumbers">
            <li class="next">ALTER TABLE, FETCH, REVOKE, CREATE, </li>
                <li class="next">GRANT, SELECT, DELETE,
                    INSERT, TRUNCATE TABLE</li>
                    <li class="next">DROP, OPEN, and UPDATE</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-0</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">
                        SET IMPLICIT_TRANSACTIONS ON;
                        
                        SET IMPLICIT_TRANSACTIONS OFF;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Jawne transakcje są lepsze
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Polecenia transakcyjne</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">BEGIN TRANSACTION :</span> punkt startowy tranzakcji</li>
            <li class="next"><span class="green">ROLLBACK TRANSACTION :</span> cofnięcie wszystkich operacji wewnątrz tranzakcji</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Polecenia transakcyjne</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">COMMIT TRANSACTION : </span>potwierdź tranzakcje </li>
            <li class="next"><span class="green">BEGIN DISTRIBUTED
                TRANSACTION :</span> rozpoczniji tranzakcje dla wielu serwerów przy użyciu Microsoft Distributed Transaction Coordinator</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Polecenia transakcyjne</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">SAVE TRANSACTION :</span> zapisz punkt tranzakcji do którego można wrócić</li>
            <li class="next"><span class="green">@@TRANCOUNT :</span> zwraca liczbę aktywnych tranzakcji</li>
        </ol>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-1<br /><span>Używanie jawnych transakcji
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-1 Używanie jawnych transakcji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 15px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 15px !important;">
                        /* -- Before count */
                        SELECT BeforeCount = COUNT(*)
                        FROM HumanResources.Department;

                        /* -- Variable to hold the latest error integer value */
                        DECLARE @Error int;
                        BEGIN TRANSACTION
                        INSERT INTO HumanResources.Department (Name, GroupName)
                        VALUES ('Accounts Payable', 'Accounting');
                        SET @Error = @@ERROR;
                        IF (@Error<> 0)
                        GOTO Error_Handler;

                        INSERT INTO HumanResources.Department (Name, GroupName)
                        VALUES ('Engineering', 'Research and Development');
                        SET @Error = @@ERROR;
                        IF (@Error <> 0)
                        GOTO Error_Handler;
                        COMMIT TRANSACTION

                        Error_Handler:
                        IF @Error <> 0
                        BEGIN
                            ROLLBACK TRANSACTION;
                        END

                        /* -- After count */
                        SELECT AfterCount = COUNT(*)
                        FROM HumanResources.Department;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-2<br /><span>Wyświetlanie najstarszej tranzakcji
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-2 Wyświetlanie najstarszej tranzakcji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">

                        USE AdventureWorks2014;
                        GO
                        BEGIN TRANSACTION
                        DELETE Production.ProductProductPhoto
                        WHERE ProductID = 317;

                        DBCC OPENTRAN('AdventureWorks2014');

                        ROLLBACK TRANSACTION;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/trans_01.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-3<br /><span>Pytanie o transakcje w czasie sesji
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-3 Pytanie o transakcje w czasie sesji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        --stwórzmy celowo trasakcje która nie jest zamknięta

                        SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
                        GO
                        USE AdventureWorks2014;
                        GO

                        BEGIN TRAN
                        SELECT *
                        FROM HumanResources.Department
                        INSERT INTO HumanResources.Department (Name, GroupName)
                        VALUES ('Test', 'QA');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_tanz_01.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-3-1 Pytanie o transakcje w czasie sesji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w innym oknie query
                        SELECT session_id, transaction_id, is_user_transaction, is_local
                        FROM sys.dm_tran_session_transactions
                        WHERE is_user_transaction = 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_tanz_02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-3-2 Pytanie o transakcje w czasie sesji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w innym oknie query
                        SELECT s.text
                        FROM sys.dm_exec_connections c
                        CROSS APPLY sys.dm_exec_sql_text(c.most_recent_sql_handle) s
                        WHERE c.most_recent_session_id = 51;
                        --use the session_id returned by the previous query
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_tanz_03.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-3-3 Pytanie o transakcje w czasie sesji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 18px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 18px !important;">
                        --w innym oknie query
                        SELECT transaction_begin_time
                        ,tran_type = CASE transaction_type
                        WHEN 1 THEN 'Read/write transaction'
                        WHEN 2 THEN 'Read-only transaction'
                        WHEN 3 THEN 'System transaction'
                        WHEN 4 THEN 'Distributed transaction'
                        END
                        ,tran_state = CASE transaction_state
                        WHEN 0 THEN 'not been completely initialized yet'
                        WHEN 1 THEN 'initialized but has not started'
                        WHEN 2 THEN 'active'
                        WHEN 3 THEN 'ended (read-only transaction)'
                        WHEN 4 THEN 'commit initiated for distributed transaction'
                        WHEN 5 THEN 'transaction prepared and waiting resolution'
                        WHEN 6 THEN 'committed'
                        WHEN 7 THEN 'being rolled back'
                        WHEN 8 THEN 'been rolled back'
                        END
                        FROM sys.dm_tran_active_transactions
                        WHERE transaction_id = 12969598; 
                        -- change this value to the transaction_id returned in the first
                        --query of this recipe
                        GO
                        
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_tanz_04.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-3-4 Pytanie o transakcje w czasie sesji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --stwórzmy celowo trazakcje która nie jest zamknięta

                        --SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
                        --GO
                        --USE AdventureWorks2014;
                        --GO

                        --BEGIN TRAN
                        --SELECT *
                        --FROM HumanResources.Department
                        --INSERT INTO HumanResources.Department (Name, GroupName)
                        --VALUES ('Test', 'QA'); -->
                        
                        ROLLBACK TRANSACTION;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-4<br /><span>Zobaczmy aktywność blokującą
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Locking</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Shared lock :</span>Dane mogą być odczytane, ale niezmienione gdy ten lock istnieje</li>
            <li class="next"><span class="green">Intent lock :</span> Tworzy on kolejkę która ustala kolejność połączeń jak ich prawa do odczytu i zapisu</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Locking</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Update lock :</span> Jeżeli jest modyfikacja ten lock staje się Exclusive lock. Jeżeli tak nie jest to staje się on Shared Lock</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Locking</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Exclusive lock :</span> Blokuje on jakikolwiek dostęp. Może on działać niejawnie przy INSET,DELETE, UPDATE</li>
            <li class="next"><span class="green">Schema modification :</span> Lock gdy modyfikujesz schemat tabelki</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Locking</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Key-range :</span> Lock blokujący wybrany zakres rekordów bazując na kluczu. Jeżeli robisz UPDATE między rokiem 2011-2012 to te rekordy będą zablokowane</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Locking</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Schema stability :</span> Lock który się tworzy w trakcie kompilacji zapytania. Blokuje on zmiany schemy na tabelce</li>
            <li class="next"><span class="green">Bulk update :</span> Lock dla dużych operacji kopiowania. Operacje te są szybkie, ale redukują one współbieżność w danej tabeli</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Lock Resources</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Allocation unit :</span> Zbiory pages</li>
            <li class="next"><span class="green">Application :</span> Zasób określony przez aplikacje</li>
            <li class="next"><span class="green">Database :</span> całą bazę danych</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Lock Resources</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Extent :</span> Alokacja 8 przyległych 8KB danych lub index pages</li>
            <li class="next"><span class="green">File :</span> Cały plik bazo danowy</li>
            <li class="next"><span class="green">HOBT :</span> Sterta (tabela bez clustered index czy b-tree)</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Lock Resources</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Metadata :</span> System metadanych</li>
            <li class="next"><span class="green">Object :</span> Objekt w bazie danych (tabelka,widok, procedura, funkcja) </li>
            <li class="next"><span class="green">Page :</span> 8kb blok danych albo page index</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Lock Resources</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Key :</span> Blokowanie wierszy tak aby nie było fantomowych odczytów. Zwany również jako key-range-lock</li>
            <li class="next"><span class="green">Table :</span> Tabelka</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Lock Resources</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">RID :</span> Blokowanie wiersza</li>
        </ol>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Nie wszystkie locki są kompatybilne między sobą.
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Inny lock nie może zostać umieszczony gdy zasób ma na sobie lock exclusive
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Inne transakcje muszą czekać bądź dostać timeout aby exclusive lock został zwoliony<span>
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Jak to działa?
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Jak to działa?</h2>
        <ol class="nonumbers">
            <li class="next">Locki zajmują przestrzeń w pamięci</li>
            <li class="next">Jeśli pamięci nam zabraknie to wtedy SQL Server konwertuje wiele locków na jeden duży</li>
            <li class="next">Cierpi na tym współbieżność</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Jak to działa?</h2>
        <ol class="nonumbers">
            <li class="next">Możesz zablokować eskalację lock lub ustawić jego poziom</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-4 Zobaczyć Aktywność blokująca</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --stwórzmy celowo trazakcje która nie jest zamknięta

                        USE AdventureWorks2014;
                        BEGIN TRAN
                        SELECT ProductID, ModifiedDate
                        FROM Production.ProductDocument WITH (TABLOCKX);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-4-1 Zobaczyć Aktywność blokująca</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w drugim oknie

                        SELECT sessionid = request_session_id ,
                        ResType = resource_type ,
                        ResDBID = resource_database_id ,
                        ObjectName = OBJECT_NAME(resource_associated_entity_id, 
                        resource_database_id) ,
                        
                        RMode = request_mode ,
                        RStatus = request_status
                        FROM sys.dm_tran_locks
                        WHERE resource_type IN ('DATABASE', 'OBJECT');
                        GO
                        
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_tanz_05.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-5<br /><span>Kontrola na blokowaniem Tabelki
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-5 Kontrola na blokowaniem Tabelki</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        USE AdventureWorks2014;
                        GO
                            ALTER TABLE Person.Address
                            SET ( LOCK_ESCALATION = AUTO );
                            SELECT lock_escalation,lock_escalation_desc
                            FROM sys.tables WHERE name='Address';
                        GO
                        
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide creamB  compact">
        <h2>LOCK_ESCALATION =</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">TABLE :</span> Domyślna.Eskalacja do poziomu tabelki . Całej bezwględu na to czy jest ona partycjonowana</li>
            <li class="next"><span class="green">AUTO :</span> Ustawia eskalacje do poziomu partycji jeżeli tabela jest partycjonowana. Innaczej cała tabelka</li>
            <li class="next"><span class="green">DISABLE :</span> Usuwa eskalacje</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-5 Kontrola na blokowaniem Tabelki</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        USE AdventureWorks2014;
                        GO
                            ALTER TABLE Person.Address
                            SET ( LOCK_ESCALATION = DISABLE);
                            SELECT lock_escalation,lock_escalation_desc
                            FROM sys.tables WHERE name='Address';
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-6<br /><span>Konfiguracja poziomu sesji transakcynej
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>ANSI/ISO SQL definiuje 4 typy interakcji pomiędzy tranzakcjami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Dirty reads :</span> Następuje gdy transakcje aktualizuje wiersz, a druga transakcja go odczyta zanim pierwsza transakcja się zakończy lub stwierdzi, że chce cofnąć swoją transakcje</li>
            <li class="next"><span class="green">Nonrepeatable reads :</span> Różne wyniki otrzymamy w zależności od tego czy przeczytamy dane przed czy po UPDATE</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>ANSI/ISO SQL definiuje 4 typy interakcji pomiędzy tranzakcjami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Phantom reads :</span> Wykonujemy dwa takie same odczyty. W międzyczasie kasujemy rekord i to sprawia, że dwa odczyty dają różne rezultaty</li>
            <li class="next"><span class="green">Lost updates :</span> Co jeśli mamy dwa polecenia UPDATE? Wygrywa ten który zajdzie później</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 Konfiguracja poziomu sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SET TRANSACTION ISOLATION LEVEL 
                        {   
                            READ UNCOMMITTED 
                            | READ COMMITTED
                            REPEATABLE READ
                            SNAPSHOT | SERIALIZABLE 
                        }
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Isolation Levelsi</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">READ COMMITTED (domyślny) :</span> Nie potwierdzone dane nie są odczytywane. S
                hared lock jest używany.
                Insert czy modyfikacje są możliwe na tej tabelce tak długo jak nie operuja one na wierszach z 1 transakcji
            </li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 READ COMMITTED</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        session1> BEGIN;
                        session1> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                        
                        session2> BEGIN;
                        session2> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                        session2> UPDATE names SET firstname = 'Bob' WHERE id = 7;
                        session2> SELECT firstname FROM names WHERE id = 7;
                        Bob
                        session2> COMMIT;
                        
                        session1> SELECT firstname FROM names WHERE id = 7;
                        Bob
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Isolation Levelsi</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">READ UNCOMMITTED :</span> To najmniej restrekcyjny lock. Użyteczny gdy chcesz skorzystać z transakcji na danych które wiesz, że są operowane tylko przez Ciebie</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Isolation Levelsi</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">REPEATABLE READ :</span> Odczyty są blokowane. Insert,Update,Delete mogą być wykonane na zbiorze na którym transakcja nie operuje</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 REPEATABLE READ</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        session1> BEGIN;
                        session1> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                        
                        session2> BEGIN;
                        session2> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                        session2> UPDATE names SET firstname = 'Bob' WHERE id = 7;
                        session2> SELECT firstname FROM names WHERE id = 7;
                        Bob
                        session2> COMMIT;
                        
                        session1> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Isolation Levelsi</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">SERIALIZABLE :</span> Najbardziej restrykcyjny. Range lock jest umieszczony na podstawie rezutatu wyszukiwania. Kasowanie,Aktualizacje są blokowane</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 SERIALIZABLE</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        session1> BEGIN;
                        session1> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                        
                        session2> BEGIN;
                        session2> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                        session2> UPDATE names SET firstname = 'Bob' WHERE id = 7;
                        session2> ...
                        session2> ...
                        
                        session1> END;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Isolation Levels</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">SNAPSHOT :</span> Każda transakcja ma swoją kopie na której może pracować</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 Konfiguracja poziomu sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        USE AdventureWorks2014;
                        GO
                        SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
                        GO
                            BEGIN TRANSACTION
                            SELECT AddressTypeID, Name
                            FROM Person.AddressType
                            WHERE AddressTypeID BETWEEN 1 AND 6;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 Kontrolowanie Lock na Tabelce</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SELECT resource_associated_entity_id, resource_type,
                        request_mode, request_session_id
                        FROM sys.dm_tran_locks;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --USE AdventureWorks2014;
                        --GO
                        --SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
                        --GO
                        --    BEGIN TRANSACTION
                        --    SELECT AddressTypeID, Name
                        --    FROM Person.AddressType
                        --    WHERE AddressTypeID BETWEEN 1 AND 6;
                        --GO

                        COMMIT TRANSACTION;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        USE AdventureWorks2014;
                        GO
                        SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
                        GO
                            BEGIN TRANSACTION
                            SELECT AddressTypeID, Name
                            FROM Person.AddressType
                            WHERE AddressTypeID BETWEEN 1 AND 6;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 Kontrolowanie Lock na Tabelce</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SELECT resource_associated_entity_id, resource_type,
                        request_mode, request_session_id
                        FROM sys.dm_tran_locks;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --USE AdventureWorks2014;
                        --GO
                        --SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
                        --GO
                        --    BEGIN TRANSACTION
                        --    SELECT AddressTypeID, Name
                        --    FROM Person.AddressType
                        --    WHERE AddressTypeID BETWEEN 1 AND 6;
                        --GO

                        COMMIT TRANSACTION;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        ALTER DATABASE AdventureWorks2014
                        SET ALLOW_SNAPSHOT_ISOLATION ON;
                        GO
                        USE AdventureWorks2014;
                        GO
                        SET TRANSACTION ISOLATION LEVEL SNAPSHOT;
                        GO
                            BEGIN TRANSACTION
                            SELECT CurrencyRateID,EndOfDayRate
                            FROM Sales.CurrencyRate
                            WHERE CurrencyRateID = 8317;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        -- w innym oknie 

                        USE AdventureWorks2014;
                        GO
                        UPDATE Sales.CurrencyRate
                        SET EndOfDayRate = 1.00
                        WHERE CurrencyRateID = 8317;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        -- w oknie tranzakcji

                        SELECT CurrencyRateID,EndOfDayRate
                        FROM Sales.CurrencyRate
                        WHERE CurrencyRateID = 8317;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        -- w oknie tranzakcji

                        COMMIT TRANSACTION;
                        SELECT CurrencyRateID,EndOfDayRate
                        FROM Sales.CurrencyRate
                        WHERE CurrencyRateID = 8317;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-7<br /><span>Szukanie blokady i jej usuowanie
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Blokowanie
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Dlaczego blokowanie może nastąpić</h2>
        <ol class="nonumbers">
            <li class="next">Jeżeli tabelka nie ma indeksów wtedy SQL Server może blokować całą tabelkę</li>
            <li class="next">Aplikacja trzyma transakcje otwartą czekaja na interakcje z użytkownikiem</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Dlaczego blokowanie może nastąpić</h2>
        <ol class="nonumbers">
            <li class="next">Zapytanie ustawia lock na całej tabelce mimo iż operują na kilku rekordach</li>
            <li class="next">Zdarzają transakcje które robią dużą ilość aktualizacji</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-7 Szukanie blokady i jej usuowanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        KILL {SPID | UOW} [WITH STATUSONLY]
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide creamB  compact">
        <h2>KILL Command Arguments</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">SPID :</span> ID Sesji którą chcemy zamknać</li>
            <li class="next"><span class="green">UOW :</span> ID transakcji</li>
            <li class="next"><span class="green">WITH STATUSONLY :</span> Dostaniesz estymacje ile potrwa cofinięce blokującej transakcji</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-7 Szukanie blokady i jej usuowanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --na jednym oknie
                        USE AdventureWorks2014;
                        GO
                        BEGIN TRAN
                        UPDATE Production.ProductInventory
                        SET Quantity = 400
                        WHERE ProductID = 1 AND LocationID = 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-7 Szukanie blokady i jej usuowanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w drugim oknie
                        USE AdventureWorks2014;
                        GO
                        BEGIN TRAN
                        UPDATE Production.ProductInventory
                        SET Quantity = 406
                        WHERE ProductID = 1 AND LocationID = 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-7 Szukanie blokady i jej usuowanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w trzecim oknie
                        SELECT blocking_session_id, wait_duration_ms, session_id
                        FROM sys.dm_os_waiting_tasks
                        WHERE blocking_session_id IS NOT NULL;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/trans_02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-7 Szukanie blokady i jej usuowanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w czwartym oknie
                        SELECT t.text
                        FROM sys.dm_exec_connections c
                        CROSS APPLY sys.dm_exec_sql_text (c.most_recent_sql_handle) t
                        WHERE c.session_id = 55; --użyj blocking_session_id z poprzedniego zapytania
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/trans_03.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-7 Szukanie blokady i jej usuowanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        KILL 55;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-8<br /><span>Konfiguranie tego jak długo wyrażenie może przetrzymać lock, aż do jego wyzwolenia
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-8 Konfiguranie tego jak długo wyrażenie może przetrzymać lock, aż do jego wyzwolenia</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SET LOCK_TIMEOUT timeout_period
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-8 Konfiguranie tego jak długo wyrażenie może przetrzymać lock, aż do jego wyzwolenia</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SET LOCK_TIMEOUT timeout_period
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-8-1 Konfiguranie tego jak długo wyrażenie może przetrzymać lock, aż do jego wyzwolenia</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        USE AdventureWorks2014;
                        GO
                        BEGIN TRAN
                        UPDATE Production.ProductInventory
                        SET Quantity = 400
                        WHERE ProductID = 1 AND LocationID = 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-8-2 Konfiguranie tego jak długo wyrażenie może przetrzymać lock, aż do jego wyzwolenia</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        USE AdventureWorks2014;
                        GO
                        SET LOCK_TIMEOUT 5000;
                        UPDATE Production.ProductInventory
                        SET Quantity = 406
                        WHERE ProductID = 1 AND LocationID = 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Deadlock
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Jak Deadlock może nastąpić?</h2>
        <ol class="nonumbers">
            <li class="next">Aplikacja sięga do tabelek za każdym razem w innej kolejności. Zakładając, że masz takie dwie sesje to mogą one wzajemnie się zablokować</li>
            <li class="next">Aplikacja ma transakcje które są długie i operują na dużej liczbie rekordów</li>
            <li class="next">Eskalacja na dwóch sesjach spowodowała deadlock</li>
        </ol>
    </section>
    <!-- <section class="slide creamB">
        <span class="shout colors">8-9<br /><span>Szukanie deadlock-u poprzez Trace Flag
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Chociaż w przypadku deadlock-ów bardziej byś skorzystał z "SQL Profiler"
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Trace Flag</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        DBCC TRACEON ( trace# [ ,...n ][ ,-1 ] ) [ WITH NO_INFOMSGS ]
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>DBCC TRACEON Command Arguments</h2>
        <ol class="nonumbers">
            <li class="next">trace# : flaga do śledzenia</li>
            <li class="next">-1 : poziom dostępności flagi</li>
            <li class="next">WITH NO_INFOMSGS : ogranicza informację w DBCC</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Trace Flag</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        DBCC TRACESTATUS ( [ [ trace# [,...n ]][,][ -1 ]]) [ WITH NO_INFOMSGS ]
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>DBCC TRACESTATUS Command Arguments</h2>
        <ol class="nonumbers">
            <li class="next">trace# [,...n ]]: flaga do śledzenia</li>
            <li class="next">-1 : poziom dostępności flagi</li>
            <li class="next">WITH NO_INFOMSGS : ogranicza informację w DBCC</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Trace Flag</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        DBCC TRACEOFF ( trace# [ ,.. .n ] [ , -1 ] ) [ WITH NO_INFOMSGS ]
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>DBCC TRACEOFF Command Arguments</h2>
        <ol class="nonumbers">
            <li class="next">trace# [,...n ]]: flaga do wyłączenia</li>
            <li class="next">-1 : poziom dostępności flagi</li>
            <li class="next">WITH NO_INFOMSGS : ogranicza informację w DBCC</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Trace Flag</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w pierwszym oknie
                        USE AdventureWorks2014;
                        GO
                        SET NOCOUNT ON;
                        WHILE 1=1
                        BEGIN
                        BEGIN TRANSACTION
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 1
                        WHERE BusinessEntityID = 1494;
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 2
                        WHERE BusinessEntityID = 1492;
                        COMMIT TRANSACTION
                        EN
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Trace Flag</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w pierwszym oknie
                        USE AdventureWorks2014;
                        GO
                        SET NOCOUNT ON;
                        WHILE 1=1
                        BEGIN
                        BEGIN TRANSACTION
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 1
                        WHERE BusinessEntityID = 1494;
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 2
                        WHERE BusinessEntityID = 1492;
                        COMMIT TRANSACTION
                        END
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Trace Flag</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        DBCC TRACEON (1222, -1)
                        GO
                        DBCC TRACESTATUS
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section> -->
    <section class="slide creamB">
        <span class="shout colors">8-9<br /><span>Szukanie deadlock-u poprzez Extended Events
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Extended Events</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --pierwsze okno
                        USE AdventureWorks2014;
                        GO
                        SET NOCOUNT ON;
                        SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
                        WHILE 1=1
                        BEGIN
                        BEGIN TRAN
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 1
                        WHERE BusinessEntityID = 1494;
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 2
                        WHERE BusinessEntityID = 1492;
                        COMMIT TRAN
                        END
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Extended Events</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --drugie okno
                        USE AdventureWorks2014;
                        GO
                        SET NOCOUNT ON;
                        WHILE 1=1
                        BEGIN
                        BEGIN TRANSACTION
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 2
                        WHERE BusinessEntityID = 1492;
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 1
                        WHERE BusinessEntityID = 1494;
                        COMMIT TRANSACTION
                        END
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Extended Events</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 22px !important;">
                        --trzecie okno

                        CREATE EVENT SESSION [Deadlock] ON SERVER
                        ADD EVENT sqlserver.lock_deadlock(
                        ACTION(sqlserver.database_name,sqlserver.plan_handle,sqlserver.sql_text)),
                        ADD EVENT sqlserver.xml_deadlock_report
                        ADD TARGET package0.event_file(SET filename=N'D:\Deadlock.xel')

                        --Ensure the file path exists and permissions are set or change the path.

                        WITH (STARTUP_STATE=ON)
                        GO
                        ALTER EVENT SESSION Deadlock
                        ON SERVER
                        STATE = START;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Extended Events</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 22px !important;">
                        --czwarte okno

                        SELECT TargetData AS DeadlockGraph
                        FROM
                        (SELECT CAST(event_data AS xml) AS TargetData
                        FROM sys.fn_xe_file_target_read_file
                        ('D:\Deadlock*.xel',NULL,NULL, NULL)
                        )
                        AS Data
                        WHERE 
                        TargetData.value('(event/@name)[1]', 'varchar(50)') = 'xml_deadlock_report';
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-10<br /><span>Ustawienie priorytet do Deadlock
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-10 Ustawienie priorytet do Deadlock</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SET DEADLOCK_PRIORITY { LOW | NORMAL | HIGH | <numeric-priority> }
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-10 Ustawienie priorytet do Deadlock</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SET DEADLOCK_PRIORITY { LOW | NORMAL | HIGH | [numeric-priority] }
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>SET DEADLOCK_PRIORITY Command Arguments</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">LOW :</span> Ustawiasz obecne połączenie jako niski powód do deadlock-ui>
            <li class="next"><span class="green">NORMAL :</span> SQL Server oceni które połączenie trzeba cofnąć</li>
            <li class="next"><span class="green">HIGH :</span> Ustawiasz wysokie ryzko deadlock-u chyba, że inne połączenie też jest HIGH</li>
            <li class="next"><span class="green">[numeric-priority] :</span> Twoja liczba od -10 do 10</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-10 Ustawienie priorytet do Deadlock</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">

                        USE AdventureWorks2014;
                        GO
                        SET NOCOUNT ON;
                        SET DEADLOCK_PRIORITY LOW;

                        WHILE 1=1
                        BEGIN
                        BEGIN TRANSACTION
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 1
                        WHERE BusinessEntityID = 1492;
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 2
                        WHERE BusinessEntityID = 1494;
                        COMMIT TRANSACTION
                        END
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide creamB">
        <span class="shout colors"><span>9. Pracowanie ze stringami
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">CONCAT :</span> Łączy napisy</li>
            <li class="next"><span class="green">ASCII and CHAR :</span> ASCII bierze znak najbardziej po lewej i zwraca kod ASCII. CHAR konwertuje liczbę ASCII na znak</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">CHARINDEX and PATINDEX :</span> CHARINDEX zwraca indeks początku jednego napisu w drugim. PATINDEX działa podobnie, ale możesz użyć wild card</li>
            <li class="next"><span class="green">DIFFERENCE and SOUNDEX :</span> Sprawdzenie czy napisy są róźne i czy brzmią tak samo</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">FORMAT :</span> MOdyfikuje DATE/TIME na string</li>
            <li class="next"><span class="green">LEFT and RIGHT :</span> Zwraca część napisu zaczynając od liczby znaków od lewej</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">LEN and DATALENGTH :</span> LEN zwraca liczbę znaków w napisie pomijając białe znaki po ostatnim zanku. DATALENGHT zwraca liczbę bajtów użytych. </li>
            <li class="next"><span class="green">LOWER and UPPER :</span> Zmiana wielości napisu</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">LTRIM and RTRIM :</span> Usuwa białe znaki</li>
            <li class="next"><span class="green">NCHAR and UNICODE :</span> UNICODE zwraca liczbę całkowitą dla pierwszego znaku. NCHAR przyjmmuje liczbę całkowitą UNICODE i zwarca znak</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">QUOTENAME :</span> Zwraca UNICODE i dodadaje delimiter aby był to okej dla SQL Server</li>
            <li class="next"><span class="green">REPLACE :</span> Zastępuje jeden napis drugim</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">REPLICATE :</span> Powtarza dany znak wiele razy</li>
            <li class="next"><span class="green">REVERSE :</span> Odwraca kolejność napisu</li>

        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">

            <li class="next"><span class="green">SPACE :</span> Zna liczbę znaków spacji tyle ile razy chcesz</li>
            <li class="next"><span class="green">STR :</span> Zmienia numeryczną dane na string</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">STUFF :</span> Kasuje w określonym miejscu teskt i wstawia nowy</li>
            <li class="next"><span class="green">SUBSTRING :</span> Zwraca część napisu</li>
        </ol>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-1<br /><span>Łączenie napisów
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-1 Łączenie napisów</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 35px !important;">
                        SELECT TOP (15)
                        FullName = 
                        CONCAT(LastName, ', ', FirstName, ' ', MiddleName)
                        FROM Person.Person p;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_01.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-2<br /><span>Znajdź wartość ASCII
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-2 Znajdź wartość ASCII</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SELECT ASCII('c'),
                        ASCII('e'),
                        ASCII('z'),
                        ASCII('a'),
                        ASCII('r');

                        SELECT CHAR(99),
                        CHAR(101),
                        CHAR(122),
                        CHAR(97),
                        CHAR(114) ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-3<br /><span>Znajdź wartość cyfrową kodu UNICODE
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-3 Znajdź wartość cyfrową kodu UNICODE</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SELECT UNICODE('G'),
                        UNICODE('o'),
                        UNICODE('o'),
                        UNICODE('d'),
                        UNICODE('!');

                        SELECT NCHAR(71),
                        NCHAR(111),
                        NCHAR(111),
                        NCHAR(100),
                        NCHAR(33) ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_03.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-4<br /><span>Lokalizowanie znaków w stringu
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-4 Lokalizowanie znaków w stringu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 35px !important;">
                        SELECT CHARINDEX('string to find',
                        'Znajdź mi "string to find" w tym napisie');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_04.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-4 Lokalizowanie znaków w stringu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 35px !important;">
                        SELECT TOP 18
                        AddressID,
                        AddressLine1,
                        PATINDEX('%[0]%Mt%', AddressLine1)
                        FROM Person.Address
                        WHERE PATINDEX('%[0]%Mt%', AddressLine1) > 0;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_05.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-5<br /><span>Porównywanie napisów
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-5 Porównywanie napisów</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 35px !important;">
                        SELECT DISTINCT
                        SOUNDEX(LastName),
                        SOUNDEX('Smi'),
                        LastName
                        FROM Person.Person
                        WHERE SOUNDEX(LastName) = SOUNDEX('Smi');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_06.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-6<br /><span>Zwracanie napisów po lewej i po prawej
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-6 Zwracanie napisów po lewej i po prawej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT LEFT('Chce tylko 10 znaków po lewej', 10);

                        SELECT RIGHT('Chce tylko 10 znaków po prawej', 10);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_07.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-6-1 Zwracanie napisów po lewej i po prawej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">
                        SELECT TOP (18)
                        ProductNumber,
                        ProductName = LEFT(Name, 10),
						ProductName = RIGHT(Name, 10)
                        FROM Production.Product;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">

                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_08.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-7<br /><span>Zwracanie tylko części napisu
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-7 Zwracanie tylko części napisu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT TOP (18)
                        PhoneNumber,
                        AreaCode = LEFT(PhoneNumber, 3),
                        Exchange = SUBSTRING(PhoneNumber, 5, 3)
                        FROM Person.PersonPhone
                        WHERE PhoneNumber LIKE 
                        '[0-9][0-9][0-9]-[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]';
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_09.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-8<br /><span>Liczenie długości napisu
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-8 Liczenie długości napisu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT LEN(N'SQL został opracowany w latach 70. w firmie IBM. 
						Stał się standardem w komunikacji z 
						serwerami relacyjnych baz danych.');

                        SELECT DATALENGTH(N'SQL został opracowany w latach 70. w firmie IBM. 
						Stał się standardem w komunikacji z serwerami relacyjnych baz danych.');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_010.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-8-1 Liczenie długości napisu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">
                        SELECT
                        DATALENGTH(123) as [123],
                        DATALENGTH(123.0) as [123.0],
						DATALENGTH('123') as ['123'],
                        DATALENGTH(GETDATE()) as [GetDate];
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_11.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-9<br /><span>Zastąpienie części napisu
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-9 Zastąpienie części napisu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT REPLACE('Pierwszą firmą, która włączyła SQL
                        do swojego produktu komercyjnego, był Oracle.'
                        , 'Oracle', 'Lichy Dzwig');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_12.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-10<br /><span>Umieść napis w X
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-10 Umieść napis w X</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT STUFF ( 'Mój kot ma na imię X. Poznałeś go?', 18, 1, 'Stefan' );
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_13.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-11<br /><span>Zmiana wielkości znaków
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-11 Zmiana wielkości znaków</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 30px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 30px !important;">
                        SELECT LOWER(DocumentSummary)
                        FROM Production.Document
                        WHERE FileName = 'Installing Replacement Pedals.doc';

                        SELECT UPPER(DocumentSummary)
                        FROM Production.Document
                        WHERE FileName = 'Installing Replacement Pedals.doc';
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_14.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-12<br /><span>Usuwanie i dodawanie białych znaków
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-12 Usuwanie i dodawanie białych znaków</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT CONCAT('||', 
						LTRIM('         Napis       '), 
                        '||' );

                        SELECT CONCAT('||', 
						RTRIM('         Napis       '),
                         '||' );
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_15.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-13<br /><span>Potwórz znaki wiele razy
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-13 Potwórz znaki wiele razy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">
                        SELECT REPLICATE ('W', 30) ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_16.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-14<br /><span>Potwórz białe znaki wiele razy
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-14 Potwórz białe znaki wiele razy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DECLARE @animals TABLE
                        (
							string1 VARCHAR(20),
							string2 VARCHAR(20),
							string3 VARCHAR(20)
                        );

                        INSERT @animals
                        VALUES ('elephant', 'dog', 'giraffe'),
                        ('kitty', 'puppy', 'ant'),
                        ('chicken', 'fish', 'marmacet');

                        SELECT CONCAT(string1, SPACE(40 - LEN(string1)),
                        string2, SPACE(40 - LEN(string2)),
                        string3, SPACE(40 - LEN(string3))) AS a
                        FROM @animals
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_17.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-15<br /><span>Odwrócenie kolejności znaków
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-15 Odwrócenie kolejności znaków</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">
                        SELECT REVERSE('Jak Programowac');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_18.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>10. Pracowanie z datami
        </span></span>
    </section>
    <section class="slide cream  compact">
        <h2>Typy reprezentuje czas</h2>
        <ol>
            <li class="next"><span class="green">Time : hh:mm:ss[.nnnnnnn] :</span> Dokładność 100 nanoseconds</li>
            <li class="next"><span class="green">Date :</span></li>
        </ol>
    </section>
    <section class="slide cream  compact">
        <h2>Typy reprezentuje czas</h2>
        <ol>
            <li class="next"><span class="green">Smalldatetime : hh:mm:ss[.nnnnnnn] : </span>Dokładność 100 nanoseconds</li>
            <li class="next"><span class="green">Datetime : </span></li>
        </ol>
    </section>
    <section class="slide cream  compact">
        <h2>Typy reprezentuje czas</h2>
        <ol>
            <li class="next"><span class="green">datetime2 : hh:mm:ss[.nnnnnnn] :</span> Dokładność 100 nanoseconds</li>
            <li class="next"><span class="green">Datetimeoffset :</span> </li>
        </ol>
    </section>
    <section class="slide creamB">
        <span class="shout colors">10-1<br /><span> Zwrócenie obecnej daty i czasu
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-1 Zwrócenie obecnej daty i czasu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 22px !important;">
                        SELECT 'GETDATE()' AS [Function], GETDATE() AS [Value];
                        SELECT 'CURRENT_TIMESTAMP'AS [Function], CURRENT_TIMESTAMP AS [Value];
                        SELECT 'GETUTCDATE()' AS [Function], GETUTCDATE() AS [Value];
                        SELECT 'SYSDATETIME()' AS [Function], SYSDATETIME() AS [Value];
                        SELECT 'SYSUTCDATETIME()' AS [Function], SYSUTCDATETIME() AS [Value];
                        SELECT 'SYSDATETIMEOFFSET()' AS [Function], SYSDATETIMEOFFSET() AS [Value];
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_01.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">10-2<br /><span> Konwertowanie pomiędzy strefami czasowymi
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-2 Konwertowanie pomiędzy strefami czasowymi</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 35px !important;">
                        SELECT SWITCHOFFSET(SYSDATETIMEOFFSET(), '+08:00');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">10-3<br /><span> Konwertowanie daty/czasu na Datetimeoffset
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-3 Konwertowanie daty/czasu na Datetimeoffset</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT TODATETIMEOFFSET(GETDATE(), '-08:00') AS [USA Zone Time],
                        SYSDATETIMEOFFSET() [Current System Time];
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_03.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">10-4<br /><span> Incrementowantowanie wartości daty
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-4 Incrementowantowanie wartości daty</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 35px !important;">
                        SELECT 
                        DATEADD(YEAR, -1, '2009-04-02T00:00:00'),
						DATEADD(MONTH, -1, '2009-04-02T00:00:00'),
						DATEADD(HOUR, -740, '2009-04-02T00:00:00');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_04.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">10-5<br /><span>Znajdź róźnice pomiędzy dwoma datami
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-5 Znajdź róźnice pomiędzy dwoma datami</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 30px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 30px !important;">
                        SELECT TOP (18)
                        ProductID,
                        GETDATE() AS Today,
                        EndDate,
                        DATEDIFF(MONTH, EndDate, GETDATE()) AS ElapsedMonths
                        FROM Production.ProductCostHistory
                        WHERE EndDate IS NOT NULL
                        ORDER BY ProductID;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_05.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-5-1 Znajdź róźnice pomiędzy dwoma datami</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        WITH cteDates (StartDate, EndDate) AS
                        (
                            SELECT CONVERT(DATETIME2, '2019-12-31T23:59:59.9999999'),
                            CONVERT(DATETIME2, '2020-01-01T00:00:00.0000000')
                        )

                        SELECT StartDate,
                        EndDate,
                        DATEDIFF(YEAR, StartDate, EndDate) AS Years,
                        DATEDIFF(QUARTER, StartDate, EndDate) AS Quarters,
                        DATEDIFF(MONTH, StartDate, EndDate) AS Months,
                        DATEDIFF(DAY, StartDate, EndDate) AS Days,
                        DATEDIFF(HOUR, StartDate, EndDate) AS Hours,
                        DATEDIFF(MINUTE, StartDate, EndDate) AS Minutes,
                        DATEDIFF(SECOND, StartDate, EndDate) AS Seconds,
                        DATEDIFF(MILLISECOND, StartDate, EndDate) AS Milliseconds,
                        DATEDIFF(MICROSECOND, StartDate, EndDate) AS MicroSeconds
                        FROM cteDates;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_06.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">10-6<br /><span>Znajdź upływ czasu pomiędzy datami
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-6 Znajdź upływ czasu pomiędzy datami</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DECLARE @StartDate DATETIME2 = '2020-01-01T18:25:42.9999999',
                        @EndDate DATETIME2 = '2020-06-15T13:12:11.8675309';

                        WITH cte AS
                        (
							SELECT DATEDIFF(SECOND, @StartDate, @EndDate) AS ElapsedSeconds,
							DATEDIFF(SECOND, @StartDate, @EndDate)/60 AS ElapsedMinutes,
							DATEDIFF(SECOND, @StartDate, @EndDate)/3600 AS ElapsedHours,
							DATEDIFF(SECOND, @StartDate, @EndDate)/86400 AS ElapsedDays
                        )

                        SELECT @StartDate AS StartDate,
                        @EndDate AS EndDate,
                        CONVERT(VARCHAR(10), ElapsedDays) + ':' +
                        CONVERT(VARCHAR(10), ElapsedHours%24) + ':' +
                        CONVERT(VARCHAR(10), ElapsedMinutes%60) + ':' +
                        CONVERT(VARCHAR(10), ElapsedSeconds%60) AS [ElapsedTime (D:H:M:S)]
                        FROM cte;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_07.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">10-7<br /><span>Wyświetl mi nazwę miesiąca i dzień tygodnia
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-7 Wyświetl mi nazwę miesiąca i dzień tygodnia</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT TOP (5)
                        ProductID,
                        EndDate,
                        DATENAME(MONTH, EndDate) AS MonthName,
                        DATENAME(WEEKDAY, EndDate) AS WeekDayName
                        FROM Production.ProductCostHistory
                        WHERE EndDate IS NOT NULL
                        ORDER BY ProductID;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_08.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">10-8<br /><span>Wyświetl mi wartość liczbową reprezentującą część daty
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-8 Wyświetl mi wartość liczbową reprezentującą część daty</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT TOP (5)
                        ProductID,
                        EndDate,
                        DATEPART(YEAR, EndDate) AS [Year],
                        DATEPART(MONTH, EndDate) AS [Month],
                        DATEPART(DAY, EndDate) AS [Day]
                        FROM Production.ProductCostHistory
                        WHERE EndDate IS NOT NULL
                        ORDER BY ProductID;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_09.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">10-9<br /><span>Sprawdzenie czy napis jest poprawną datą
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-9 Sprawdzenie czy napis jest poprawną datą</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT MyData,
                        ISDATE(MyData) AS IsADate
                        FROM ( VALUES ( 'IsThisADate'),
                        ( '2020-02-14'),
                        ( '2020-01-01T00:00:00'),
                        ( '2020-12-31T23:59:59.9999999') ) dt (MyData);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_10.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">10-10<br /><span>Sprawdzenie czy jest to ostatni dzień miesiąca
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-10 Sprawdzenie czy jest to ostatni dzień miesiąca</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT MyData,
                        EOMONTH(MyData) AS LastDayOfThisMonth,
                        EOMONTH(MyData, 1) AS LastDayOfNextMonth
                        FROM (VALUES ('2020-02-14T00:00:00' ),
                        ('2020-01-01T00:00:00'),
                        ('2020-12-31T23:59:59.9999999')) dt(MyData);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_11.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">10-11<br /><span>Tworzenie daty z liczb
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-11 Tworzenie daty z liczb</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT 'DateFromParts' AS ConversionType,
                        DATEFROMPARTS(2020, 8, 15) AS [Value];
                        SELECT 'TimeFromParts' AS ConversionType,
                        TIMEFROMPARTS(18, 25, 32, 5, 1) AS [Value];
                        SELECT 'SmallDateTimeFromParts' AS ConversionType,
                        SMALLDATETIMEFROMPARTS(2020, 8, 15, 18, 25) AS [Value];
                        SELECT 'DateTimeFromParts' AS ConversionType,
                        DATETIMEFROMPARTS(2020, 8, 15, 18, 25, 32, 450) AS [Value];
                        SELECT 'DateTime2FromParts' AS ConversionType,
                        DATETIME2FROMPARTS(2020, 8, 15, 18, 25, 32, 5, 7) AS [Value];
                        SELECT 'DateTimeOffsetFromParts' AS ConversionType,
                        DATETIMEOFFSETFROMPARTS(2020, 8, 15, 18, 25, 32, 5, 4, 0, 7) AS [Value];
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_12.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">10-12<br /><span>Skrócenie dat do pierwszych...
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-12 Skrócenie dat do pierwszych...</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DECLARE @MyDate DATETIME2 = '2012-01-01T18:25:42.9999999',
                        @Base DATETIME = '1900-01-01T00:00:00',
                        @Base2 DATETIME = '2000-01-01T00:00:00';

                        -- Solution 1
                        SELECT MyDate,
                        DATEADD(YEAR, DATEDIFF(YEAR, @Base, MyDate), @Base) AS [FirstDayOfYear],
                        DATEADD(MONTH, DATEDIFF(MONTH, @Base, MyDate), @Base) AS [FirstDayOfMonth],
                        DATEADD(QUARTER,DATEDIFF(QUARTER, @Base, MyDate), @Base) AS [FirstDayOfQuarter]
                        FROM (VALUES ('1981-01-17T00:00:00'),
                        ('1961-11-23T00:00:00'),
                        ('1960-07-09T00:00:00'),
                        ('1980-07-11T00:00:00'),
                        ('1983-01-05T00:00:00'),
                        ('2006-11-27T00:00:00'),
                        ('2013-08-03T00:00:00')) dt (MyDate);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_13.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-12-2 Skrócenie dat do pierwszych...</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DECLARE @MyDate DATETIME2 = '2020-01-01T18:25:42.9999999';

                        SELECT CONVERT(CHAR(10), ca.MyDate, 121) AS MyDate,
                        CAST(FORMAT(ca.MyDate, 'yyyy-01-01') AS DATETIME) AS FirstDayOfYear,
                        CAST(FORMAT(ca.MyDate, 'yyyy-MM-01') AS DATETIME) AS FirstDayOfMonth
                        FROM (VALUES ('1981-01-17T00:00:00'),
                        ('1961-11-23T00:00:00'),
                        ('1960-07-09T00:00:00'),
                        ('1980-07-11T00:00:00'),
                        ('1983-01-05T00:00:00'),
                        ('2006-11-27T00:00:00'),
                        ('2013-08-03T00:00:00')) dt (MyDate)
                        CROSS APPLY (SELECT CAST(dt.MyDate AS DATE)) AS ca(MyDate);
                        SELECT 'StartOfHour' AS ConversionType,
                        FORMAT(@MyDate, 'yyyy-MM-dd HH:00:00.000') AS DateResult
                        UNION ALL
                        SELECT 'StartOfMinute',
                        FORMAT(@MyDate, 'yyyy-MM-dd HH:mm:00.000')
                        UNION ALL
                        SELECT 'StartOfSecond',
                        FORMAT(@MyDate, 'yyyy-MM-dd HH:mm:ss.000');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_14.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">10-13<br /><span>Dodanie brakujących dat
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">10-13 Dodanie brakujących dat</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 13px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 13px !important;">
                        DECLARE @Base DATETIME = '1900-01-01T00:00:00';
                        WITH cteExpenses AS
                        (
							SELECT ca.FirstOfMonth,
							SUM(ExpenseAmount) AS MonthlyExpenses
							FROM ( VALUES ('2012-01-15T00:00:00', 1250.00),
							('2012-01-28T00:00:00', 750.00),
							('2012-03-01T00:00:00', 1475.00),
							('2012-03-23T00:00:00', 2285.00),
							('2012-04-01T00:00:00', 1650.00),
							('2012-04-22T00:00:00', 1452.00),
							('2012-06-15T00:00:00', 1875.00),
							('2012-07-23T00:00:00', 2125.00) ) dt (ExpenseDate, ExpenseAmount)
							CROSS APPLY (SELECT DATEADD(MONTH,
							DATEDIFF(MONTH, @Base, ExpenseDate), @Base) ) ca (FirstOfMonth)
							GROUP BY ca.FirstOfMonth
                        ), cteMonths AS
                        (
                        SELECT DATEFROMPARTS(2012, M, 1) AS FirstOfMonth
                        FROM ( VALUES (1), (2), (3), (4),
                        (5), (6), (7), (8),
                        (9), (10), (11), (12) ) Months (M)
                        )
                        SELECT CAST(FirstOfMonth AS DATE) AS FirstOfMonth,
                        MonthlyExpenses
                        FROM cteExpenses
                        UNION ALL
                        SELECT m.FirstOfMonth,
                        0
                        FROM cteMonths M
                        LEFT JOIN cteExpenses e
                        ON M.FirstOfMonth = e.FirstOfMonth
                        WHERE e.FirstOfMonth IS NULL
                        ORDER BY FirstOfMonth;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/d_15.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>11. Pracowanie z liczbami
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-1<br /><span>Reprezentowanie liczb całkowitych
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-1 Reprezentowanie liczb całkowitych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DECLARE @bip bigint, @bin bigint
                        DECLARE @ip int, @in int
                        DECLARE @sip smallint, @sin smallint
                        DECLARE @ti tinyint

                        SET @bip = 9223372036854775807 /* 2^63-1 */
                        SET @bin = -9223372036854775808 /* -2^63 */
                        SET @ip = 2147483647 /* 2^31-1 */
                        SET @in = -2147483648 /* -2^31 */
                        SET @sip = 32767 /* 2^15-1 */
                        SET @sin = -32768 /* -2^15 */
                        SET @ti = 255 /* 2^8-1 */
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-2<br /><span>Tworzenie bitowe wartości
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-2 Tworzenie bitowe wartości</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DECLARE @SunnyDayFlag bit
                        SET @SunnyDayFlag = 1;
                        SET @SunnyDayFlag = 'true'
                        SELECT @SunnyDayFlag;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-3<br /><span>Reprezentowanie pieniędzy
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-3 Reprezentowanie pieniędzy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DECLARE @x0 decimal(7,0) = 1234567.
                        DECLARE @x1 decimal(7,1) = 123456.7
                        DECLARE @x2 decimal(7,2) = 12345.67
                        DECLARE @x3 decimal(7,3) = 1234.567
                        DECLARE @x4 decimal(7,4) = 123.4567
                        DECLARE @x5 decimal(7,5) = 12.34567
                        DECLARE @x6 decimal(7,6) = 1.234567
                        DECLARE @x7 decimal(7,7) = .1234567
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-4<br /><span>Reprezentowanie ułamków
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-4 Reprezentowanie ułamków</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DECLARE @x1 real /* same as float(24) */
                        DECLARE @x2 float /* same as float(53) */
                        DECLARE @x3 float(53)
                        DECLARE @x4 float(24)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-5<br /><span>Pisanie matematycznych wyrażeń
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-5 Pisanie matematycznych wyrażeń</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DECLARE @cur_bal decimal(7,2) = 94235.49
                        DECLARE @new_bal decimal(7,2)
                        SET @new_bal = @cur_bal - (500.00 - ROUND(@cur_bal * 0.06 / 12.00, 2))
                        SELECT @new_bal;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/i_01.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-6<br /><span>Rzutowanie pomiędzy typami
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-6 Rzutowanie pomiędzy typami</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT 6/100,
                        CAST(6 AS DECIMAL(1,0)) / CAST(100 AS DECIMAL(3,0)),
                        CAST(6.0/100.0 AS DECIMAL(3,2));

                        SELECT 6/100,
                        CONVERT(DECIMAL(1,0), 6) / CONVERT(DECIMAL(3,0), 100),
                        CONVERT(DECIMAL(3,2), 6.0/100.0);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/i_02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-7<br /><span>Konwertowanie liczb do tekstu
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-7 Konwertowanie liczb do tekstu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT ProductID, Name,
                        CONVERT(NVARCHAR, ListPrice, 1) AS 'Price',
                        CONVERT(NVARCHAR, Weight) AS 'Weight'
                        FROM Production.Product
                        WHERE ListPrice > 0 AND Weight IS NOT NULL;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/i_03.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-8<br /><span>Konwertowanie tekstu do liczb
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-8 Konwertowanie tekstu do liczb</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT 0-CONVERT(DECIMAL, NationalIDNumber) AS 'Negative ID'
                        FROM HumanResources.Employee;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/i_04.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-9<br /><span>Zaokrąglanie
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-9 Zaokrąglanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT EndOfDayRate,
                        ROUND(EndOfDayRate,0) AS EODR_Dollar,
                        ROUND(EndOfDayRate,2) AS EODR_Cent
                        FROM Sales.CurrencyRate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/i_05.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-10<br /><span>Zaokrąglanie w dół lub w góre zawsze
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-10 Zaokrąglanie w dół lub w góre zawsze</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT CEILING(-1.23), FLOOR (-1.23), CEILING(1.23), FLOOR(1.23);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/i_06.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-11<br /><span>Odrzucanie Decimal
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-11 Odrzucanie Decimal</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT ROUND(123.99,0,1), ROUND(123.99,1,1), ROUND(123.99,-1,1);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/i_07.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-12<br /><span>Testowanie równości ułamków
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-12 Testowanie równości ułamków</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DECLARE @r1 real = 0.95
                        DECLARE @f1 float = 0.95
                        IF ABS(@r1-@f1) < 0.000001
                        SELECT 'Equal'
                        ELSE
                        SELECT 'Not Equal'
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/i_08.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-13<br /><span>Traktowanie nulli jako zero
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-13 Traktowanie nulli jako zero</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT SpecialOfferID, MaxQty, COALESCE(MaxQty, 0) AS MaxQtyAlt
                        FROM Sales.SpecialOffer;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/i_09.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-14<br /><span>Generowanie sekwencji liczb
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-14 Generowanie sekwencji liczb</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        WITH ones AS (
                            SELECT *
                            FROM (VALUES (0), (1), (2), (3), (4),
                            (5), (6), (7), (8), (9)) AS numbers(x)
                        )

                        SELECT 1000*o1000.x + 100*o100.x + 10*o10.x + o1.x x
                        FROM ones o1, ones o10, ones o100, ones o1000
                        ORDER BY x;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/i_10.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">11-15<br /><span>Generowanie losowych liczb całkowitych z
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">11-15 Generowanie losowych liczb całkowitych z </h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DECLARE @rmin int, @rmax int;
                        SET @rmin = 900;
                        SET @rmax = 1000;
                        SELECT Name,
                        CAST(RAND(CHECKSUM(NEWID())) * (@rmax-@rmin) AS INT) + @rmin
                        FROM Production.Product;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/i_11.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>


    <section class="slide creamB">
        <span class="shout colors"><span>12. Inserty, Updaty, Delety
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors">12-1<br /><span>Insert nowego wiersza
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-1 Insert nowego wiersza</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        INSERT INTO Production.Location
                        (Name, CostRate, Availability)
                        VALUES ('Wheel Storage', 11.25, 80.00) ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/iud-01.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-2 Insert : Określanie wartości domyślnych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        INSERT Production.Location
                        (Name,
                        CostRate,
                        Availability,
                        ModifiedDate)
                        VALUES ('Wheel Storage 3',
                        11.25,
                        80.00,
                        DEFAULT) ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/iud-02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-2-1 Insert : Określanie wartości domyślnych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        INSERT INTO Person.Address
                        (AddressLine1,
                        AddressLine2,
                        City,
                        StateProvinceID,
                        PostalCode)
                        VALUES ('15 Wake Robin Rd',
                        DEFAULT,
                        'Sudbury',
                        30,
                        '01776') ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/iud-02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-3 INSERT : Napisanie kolumny IDENTITY</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SET IDENTITY_INSERT HumanResources.Department ON;

                        INSERT HumanResources.Department (DepartmentID, Name, GroupName)
                        VALUES (17, 'Database Services', 'Information Technology');

                        SET IDENTITY_INSERT HumanResources.Department OFF;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/iud-02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-4 INSERT : Generowanie GUID</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        INSERT Purchasing.ShipMethod
                        (Name,
                        ShipBase,
                        ShipRate,
                        rowguid)
                        VALUES ('MIDDLETON CARGO TS1',
                        8.99,
                        1.22,
                        NEWID());

                        SELECT rowguid,
                        Name
                        FROM Purchasing.ShipMethod
                        WHERE Name = 'MIDDLETON CARGO TS1';
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/iud-03.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-5 INSERT : na podstawie Rezultatów do zapytania query</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        INSERT Purchasing.ShipMethod
                        (Name,
                        ShipBase,
                        ShipRate,
                        rowguid)
                        VALUES ('CARGO TS1',
                        8.99,
                        1.22,
                        NEWID());

                        SELECT rowguid,
                        Name
                        FROM Purchasing.ShipMethod
                        WHERE Name = 'CARGO TS1';
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/iud-04.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-6 INSERT : na podstawie Rezultatów z Procedury</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 20px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 20px !important;">
                        CREATE PROCEDURE dbo.usp_SEL_Production_TransactionHistory
                        @ModifiedStartDT DATETIME,
                        @ModifiedEndDT DATETIME
                        AS
                            SELECT TransactionID,
                            ProductID,
                            ReferenceOrderID,
                            ReferenceOrderLineID,
                            TransactionDate,
                            TransactionType,
                            Quantity,
                            ActualCost,
                            ModifiedDate
                            FROM Production.TransactionHistory
                            WHERE ModifiedDate BETWEEN @ModifiedStartDT
                            AND @ModifiedEndDT
                            AND TransactionID NOT IN (
                            SELECT TransactionID
                            FROM Production.TransactionHistoryArchive) ;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-6-1 INSERT : na podstawie Rezultatów z Procedury</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        INSERT Production.TransactionHistoryArchive
                            (TransactionID,
                            ProductID,
                            ReferenceOrderID,
                            ReferenceOrderLineID,
                            TransactionDate,
                            TransactionType,
                            Quantity,
                            ActualCost,
                            ModifiedDate)

                        EXEC dbo.usp_SEL_Production_TransactionHistory '2013-09-01', '2013-09-02' ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/iud-05.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-7 INSERT : Wielu wierszy na raz gdy wartości są znane</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        CREATE TABLE HumanResources.Degree
                        (
                            DegreeID INT NOT NULL
                            IDENTITY(1, 1)
                            PRIMARY KEY,
                            DegreeName VARCHAR(30) NOT NULL,
                            DegreeCode VARCHAR(5) NOT NULL,
                            ModifiedDate DATETIME NOT NULL
                        ) ;
                        GO

                        INSERT INTO HumanResources.Degree
                        (DegreeName, DegreeCode, ModifiedDate)
                        VALUES ('Bachelor of Arts', 'B.A.', GETDATE()),
                        ('Bachelor of Science', 'B.S.', GETDATE()),
                        ('Master of Arts', 'M.A.', GETDATE()),
                        ('Master of Science', 'M.S.', GETDATE()),
                        ('Associate" s Degree', 'A.A.', GETDATE()) ;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/iud-06.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-8 INSERT : Wierszy i zwrócenie tego co się umieściło</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        INSERT Purchasing.ShipMethod
                        (Name, ShipBase, ShipRate)

                        OUTPUT INSERTED.ShipMethodID, INSERTED.Name,
                        INSERTED.rowguid, INSERTED.ModifiedDate
                        VALUES ('MIDDLETON CARGO TS11', 10, 10),
                        ('MIDDLETON CARGO TS12', 10, 10),
                        ('MIDDLETON CARGO TS13', 10, 10) ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/iud-07.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-9 Update : Pojedyńczy wiersz bądź zestaw wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 35px !important;">
                        UPDATE &#x3C;table_or_view_name&#x3E;
                        SET column_name = {expression | DEFAULT | NULL} [ ,...n ]
                        WHERE &#x3C;search_condition&#x3E;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-9 Update : Pojedyńczy wiersz bądź zestaw wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 35px !important;">
                        UPDATE Sales.SpecialOffer
                        SET DiscountPct = 0.15
                        WHERE SpecialOfferID = 10 ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-10 Update : Używając drugiej tabelki jako źródła danych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 29px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 29px !important;">
                        UPDATE &#x3C;table_or_view_name | table_or_view_alias&#x3E;
                        SET column_name = {expression | DEFAULT | NULL} [ ,...n ]
                        FROM &#x3C;table_source&#x3E;
                        WHERE &#x3C;search_condition&#x3E;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-10 Update : Używając drugiej tabelki jako źródła danych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        UPDATE c
                        SET Quantity = 2,
                        ModifiedDate = GETDATE()
                        FROM Sales.ShoppingCartItem c
                        INNER JOIN Production.Product p
                        ON c.ProductID = p.ProductID
                        WHERE p.Name = 'Full-Finger Gloves, M '
                        AND c.Quantity > 2 ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-11 Update : Aktualizacja i zwórcenie rekordów które się zmieniły</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        UPDATE Sales.SpecialOffer
                        SET DiscountPct *= 1.05
                        OUTPUT inserted.SpecialOfferID,
                        deleted.DiscountPct AS old_DiscountPct,
                        inserted.DiscountPct AS new_DiscountPct
                        WHERE Category = 'Customer' ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/iud-08.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide cream  compact">
        <h2>12-12 Update : Zmiana GIGATYCZNYCH wartości w kolumnach</h2>
        <ol>
            <li class="next">varchar(max)</li>
            <li class="next">nvarchar(max)</li>
            <li class="next">varbinary(max)</li>
            <li class="next">Te typy danych mogą zajmować 2^31-1 bajtów czyli 2GB</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-12 Update : Zmiana GIGATYCZNYCH wartości w kolumnach</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        UPDATE &#x3C;table_or_view_name&#x3E;
                        SET column_name.WRITE (expression, (@Offset, @Length)
                        FROM &#x3C;table_source&#x3E;
                        WHERE &#x3C;search_condition&#x3E;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-12 Update : Zmiana GIGATYCZNYCH wartości w kolumnach</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        CREATE TABLE dbo.RecipeChapter
                        (
                            ChapterID INT NOT NULL CONSTRAINT PK_RecipeChapter PRIMARY KEY CLUSTERED,
                            Chapter VARCHAR(MAX) NOT NULL
                        ) ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-13-1 Update : Zmiana GIGATYCZNYCH wartości w kolumnach</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        INSERT INTO dbo.RecipeChapter
                        (ChapterID,
                        Chapter)
                        VALUES (1,
                        'At the beginning of each chapter you will notice
                        that basic concepts are covered first.') ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-13-2 Update : Zmiana GIGATYCZNYCH wartości w kolumnach</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        UPDATE dbo.RecipeChapter
                        SET Chapter.WRITE('In addition to the basics, this chapter will also provide recipes
                        that can be used in your day to day development and administration.',
                        NULL, NULL)
                        WHERE ChapterID = 1 ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-13-2 Update : Zmiana GIGATYCZNYCH wartości w kolumnach</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        UPDATE dbo.RecipeChapter
                        SET Chapter.WRITE('daily', CHARINDEX('day to day', Chapter) - 1,
                        LEN('day to day'))
                        WHERE ChapterID = 1 ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-13-3 Update : Zmiana GIGATYCZNYCH wartości w kolumnach</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT Chapter
                        FROM dbo.RecipeChapter
                        WHERE ChapterID = 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-13 Delete : Kasowanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DELETE Production.Example_ProductProductPhoto ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-13-2 Delete : Kasowanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DELETE Production.Example_ProductProductPhoto
                        WHERE ProductID NOT IN (SELECT ProductID
                        FROM Production.Product) ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-14 Delete : Kasowanie wierszy i zwórcenie skasowanych rekordów</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DELETE
                        FROM HumanResources.Example_JobCandidate
                        OUTPUT deleted.JobCandidateID
                        WHERE JobCandidateID < 5 ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-15 Delete : Kasowanie wierszy szybko (Truncating)</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">
                        //TRUNCATE TABLE table_name ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-16 Merge : (Inserting, Updating, i/lub Deleting
                    Values)</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        MERGE
                        [ INTO ] &#x3C;target_table&#x3E; [ [ AS ] table_alias ]
                        USING &#x3C;table_source&#x3E; [ [ AS ] table_alias ]
                        ON &#x3C;merge_search_condition&#x3E;
                        [ WHEN MATCHED [ AND &#x3C;clause_search_condition&#x3E; ]
                        THEN &#x3C;merge_matched&#x3E; ] [ ...n ]
                                [ WHEN NOT MATCHED [ BY TARGET ] [ AND &#x3C;clause_search_condition&#x3E; ]
                        THEN &#x3C;merge_not_matched&#x3E; ]
                                [ WHEN NOT MATCHED BY SOURCE [ AND &#x3C;clause_search_condition&#x3E; ]
                        THEN &#x3C;merge_matched&#x3E; ] [ ...n ]
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-16 Merge : (Inserting, Updating, i/lub Deleting
                    Values)</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        CREATE TABLE Sales.LastCustomerOrder
                        (
                            CustomerID INT,
                            SalesOrderID INT,
                            CONSTRAINT pk_LastCustomerOrder PRIMARY KEY CLUSTERED (CustomerId)
                        ) ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-16 Merge : (Inserting, Updating, i/lub Deleting
                    Values)</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DECLARE @CustomerID INT = 100,
                        @SalesOrderID INT = 101 ;

                        MERGE INTO Sales.LastCustomerOrder AS tgt
                        USING
                        (SELECT @CustomerID AS CustomerID,
                        @SalesOrderID AS SalesOrderID
                        ) AS src
                        ON tgt.CustomerID = src.CustomerID
                        WHEN MATCHED
                        THEN UPDATE
                        SET SalesOrderID = src.SalesOrderID
                        WHEN NOT MATCHED
                        THEN INSERT (
                        CustomerID,
                        SalesOrderID
                        )
                        VALUES (src.CustomerID,
                        src.SalesOrderID) ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-16 Merge : (Inserting, Updating, i/lub Deleting
                    Values)</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        CREATE TABLE Sales.LargestCustomerOrder
                        (
                        CustomerID INT,
                        SalesOrderID INT,
                        TotalDue MONEY,
                        CONSTRAINT pk_LargestCustomerOrder PRIMARY KEY CLUSTERED (CustomerId)
                        );
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">12-17  Umieszczanie danych po OUTPUT</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        -- Create a table variable to hold the output data
                        -- This could be a temporary or a permanent table.
                        DECLARE @dml_output TABLE (
                        MergeAction VARCHAR(6),
                        DeletedCustomerID INTEGER,
                        DeletedSalesOrderID INTEGER,
                        DeletedTotalDue MONEY,
                        InsertedCustomerID INTEGER,
                        InsertedSalesOrderID INTEGER,
                        InsertedTotalDue MONEY
                        );
                        -- Insert into the holding table
                        INSERT INTO @dml_output
                        (MergeAction,
                        DeletedCustomerID,
                        DeletedSalesOrderID,
                        DeletedTotalDue,
                        InsertedCustomerID,
                        InsertedSalesOrderID,
                        InsertedTotalDue
                        )
                        -- SELECT from a table source
                        SELECT *
                        -- The FROM clause needs to be a derived table
                        -- The output columns are its output. FROM (
                        MERGE INTO Sales.LargestCustomerOrder AS tgt
                        USING
                        (SELECT 100 AS CustomerID,
                        205 AS SalesOrderID,
                        2500.00 AS TotalDue
                        ) AS src
                        ON tgt.CustomerID = src.CustomerID
                        WHEN MATCHED AND tgt.TotalDue < src.TotalDue
                        THEN UPDATE
                        SET SalesOrderID = src.SalesOrderID
                        , TotalDue = src.TotalDue
                        WHEN NOT MATCHED
                        THEN INSERT (
                        CustomerID,
                        SalesOrderID,
                        TotalDue
                        )
                        VALUES (src.CustomerID,
                        src.SalesOrderID,
                        src.TotalDue)
                        OUTPUT
                        $ACTION,
                        DELETED.*,
                        INSERTED.*
                        -- Define the derived table's output column
                        ) dt(MergeAction,
                        DeletedCustomerID,
                        DeletedSalesOrderID,
                        DeletedTotalDue,
                        InsertedCustomerID,
                        InsertedSalesOrderID,
                        InsertedTotalDue);
                        SELECT *
                        FROM @dml_output;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

  




    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/01.png" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>


    <section class="slide creamG">
        <span class="shout colors"><span>Podsumowanie
        </span></span>
    </section>
    <section class="slide creamG">
        <span class="shout colors"><span>Dzięki za obecność
        </span></span>
    </section>
    <!-- <div class="progress"></div> -->
    <footer class="badge badge-top-left">
        <a href="#" class="fullscreen">Fullscreen</a>
    </footer>

    <script src="vendors/gamepad/gamepad.js"></script>
    <script src="vendors/shower/shower.min.js"></script>
    <script src="vendors/shower-gamepad/shower.gamepad.js"></script>

    <!-- Prism.js -->
    <script src="vendors/prism/prism.js"></script>
    <script src="vendors/prism/custom-prism.js"></script>

</body>

</html>