<!DOCTYPE html>
<html lang="en">
<head>
    <title>SQL Server Szybki trening 2</title>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width" />
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans:400,900&amp;subset=latin-ext" rel="stylesheet" />
    <!-- Shower Theme -->
    <link rel="stylesheet" href="vendors/shower-ribbon/styles/screen-16x9.css" />
    <link rel="stylesheet" href="vendors/shower-CezaryWalenciuk/styles/main.css" />
    <!-- Prism.js -->
    <link rel="stylesheet" href="vendors/prism/prism.css" />
    <link rel="stylesheet" href="vendors/prism/custom-prism.css" />
    <link rel="stylesheet" href="codegrid.css" />
</head>
<body class="shower list">
    <header class="caption">
        <h1>SQL Server Szybki trening 2</h1>
        <p></p>
    </header>

    <section class="slide front-page">

        <div class="details">
            <!-- 1. Avatar -->


            <h2>Cezary Walenciuk</h2>

            <!-- 3. Presentation title -->
            <h2 class="bigbig"><strong style="font-size: 35px;  line-height: 1.3;">

                    <span class="titlec1">SQL Server Szybki Trening 2</span>
                    <span class=""></span></strong></h2>



            <!-- 5. Contact the speaker -->
            <h2><a href="https://twitter.com/WalenciukC">@walenciukC</a></h2>
        </div>
        <div>


            <!-- 2. Speaker -->

        </div>
        <div class="imag">
            <img src="images/my-avatar.jpg" alt="Speaker">
        </div>
    </section>

    <section class="slide creamB smaller  compact ">
        <ol>
            <li class="next">Przypomienie</li>
            <li class="next">Zaawansowana Zapytania SELECT</li>
            <li class="next">Windows Function</li>
            <li class="next">transakcje, Lock, Block i Deadlock</li>
            <li class="next">Daty, Liczby i stringi</li>
        </ol>
    </section>

    <section class="slide creamP">
        <span class="shout colors"><span>6. Zaawansowana Zapytania SELECT
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-0 Pobierz mi pierwsze 10 rekordów unikatowych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">
                        SELECT DISTINCT TOP (10) HireDate
                        FROM HumanResources.Employee
                        ORDER BY HireDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-0 Filtrowanie rezultatu z podzapytania</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 44px !important;">
                        SELECT s.PurchaseOrderNumber
                        FROM Sales.SalesOrderHeader s
                        WHERE EXISTS ( SELECT SalesOrderID
                        FROM Sales.SalesOrderDetail
                        WHERE UnitPrice BETWEEN 1900 AND 2000
                        AND SalesOrderID = s.SalesOrderID )
                        ORDER BY s.PurchaseOrderNumber;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_03.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-0-2 Filtrowanie rezultatu z podzapytania</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 44px !important;">
                        SELECT DISTINCT sh.PurchaseOrderNumber
                        FROM Sales.SalesOrderHeader AS sh
                        JOIN Sales.SalesOrderDetail AS sd
                        ON sh.SalesOrderID = sd.SalesOrderID
                        WHERE sd.UnitPrice BETWEEN 1900 AND 2000;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_03.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-0-3 Zwrócenie losowych wierszy z tabeli</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT FirstName,
                        LastName
                        FROM Person.Person
                        TABLESAMPLE SYSTEM (2 PERCENT);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_04.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-0<br /><span>Zapytania z gotowymi wynikami
        </span></span>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-0 Zapytania z gotowymi wynikami</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT *
                        FROM (VALUES ('Adam', 'Walkuz'),
                        ('Stefan', 'Jefferson'))
                         dtPeople(FirstName, LastName);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide creamB">
        <span class="shout colors">6-1<br /><span>Wyświetlenie danych ze zmiennych
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-1 Wyświetlenie danych ze zmiennych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        DECLARE @FirstHireDate DATE,
                        @LastHireDate DATE;

                        SELECT @FirstHireDate = MIN(HireDate),
                        @LastHireDate = MAX(HireDate)
                        FROM HumanResources.Employee;

                        SELECT @FirstHireDate AS FirstHireDate,
                        @LastHireDate AS LastHireDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/select-01.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-2<br /><span>Tworzenie nowej tabeli z wyniku zapytania
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-2 Tworzenie nowej tabeli z wyniku zapytania</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        IF OBJECT_ID('dbo.mySales') 
                        IS NOT NULL DROP TABLE dbo.mySales;

                        SELECT *
                        INTO dbo.mySales
                        FROM Sales.SalesOrderDetail
                        WHERE ModifiedDate = '2011-06-01T00:00:00.000';

                        SELECT COUNT(*) AS QtyOfRows
                        FROM dbo.mySales;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB   compact ">
        <h2>Limity</h2>
        <ol class="nonumbers">
            <li class="next">Nie możesz tworzyć  nowych tabel w innej instancji serwera</li>
            <li class="next">Nie możesz tworzyć tak zmiennej TABLE</li>
            <li class="next">Tylko dane i columny są skopiowane. Indexy,Triggery,Klucze obce nie są skopiowane</li>
        </ol>
    </section>
    <section class="slide creamB   compact ">
        <h2>Limity</h2>
        <ol class="nonumbers">
            <li class="next">Użycie ORDER BY nie gwarantuje skopiowania w tej kolejności</li>
            <li class="next">Kolumna Computed nie będzie skopiowana jako taka kolumna</li>
        </ol>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-3<br /><span>Wysłanie rekordów do funkcji
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-3 Wysłanie rekordów do funkcji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 19px !important;">
                        IF OBJECT_ID('dbo.fn_WorkOrderRouting') IS NOT NULL DROP FUNCTION dbo.fn_WorkOrderRouting;
                        GO
                        CREATE FUNCTION dbo.fn_WorkOrderRouting (@WorkOrderID INT)
                            RETURNS TABLE
                            AS
                            RETURN
                                SELECT WorkOrderID,
                                ProductID,
                                OperationSequence,
                                LocationID
                                FROM Production.WorkOrderRouting
                                WHERE WorkOrderID = @WorkOrderID;
                        GO

                        SELECT TOP (5)
                        w.WorkOrderID,
                        w.OrderQty,
                        r.ProductID,
                        r.OperationSequence
                        FROM Production.WorkOrder w
                            CROSS APPLY dbo.fn_WorkOrderRouting(w.WorkOrderID) AS r
                        ORDER BY w.WorkOrderID,
                        w.OrderQty,
                        r.ProductID;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>



    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-3-2 Wysłanie rekordów do funkcji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 26px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 26px !important;">
                        SELECT TOP (5)
                        w.WorkOrderID,
                        w.OrderQty,
                        r.ProductID,
                        r.OperationSequence
                        FROM Production.WorkOrder w
                        CROSS APPLY (
                            SELECT WorkOrderID,
                            ProductID,
                            OperationSequence,
                            LocationID
                            FROM Production.WorkOrderRouting
                            WHERE WorkOrderID = w.WorkOrderId
                        ) AS r
                        ORDER BY w.WorkOrderID,
                        w.OrderQty,
                        r.ProductID;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-4<br /><span>Zmiana wierszy na kolumny
        </span></span>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_01-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-4 Zmiana wierszy na kolumny</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">

                        SELECT s.Name AS ShiftName,
                        h.BusinessEntityID,
                        d.Name AS DepartmentName
                        FROM HumanResources.EmployeeDepartmentHistory h
                        INNER JOIN HumanResources.Department d
                        ON h.DepartmentID = d.DepartmentID
                        INNER JOIN HumanResources.Shift s
                        ON h.ShiftID = s.ShiftID
                        WHERE EndDate IS NULL
                        AND d.Name IN ('Production', 'Engineering', 'Marketing')
                        ORDER BY ShiftName;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_02-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-4-2 Zmiana wierszy na kolumny</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-sql">
                    <code style="line-height:19px !important;">

                        SELECT ShiftName,
                        Production,
                        Engineering,
                        Marketing
                        FROM 
                        
                        (   SELECT s.Name AS ShiftName,
                            h.BusinessEntityID,
                            d.Name AS DepartmentName
                            FROM HumanResources.EmployeeDepartmentHistory h
                            INNER JOIN HumanResources.Department d
                            ON h.DepartmentID = d.DepartmentID
                            INNER JOIN HumanResources.Shift s
                            ON h.ShiftID = s.ShiftID
                            WHERE EndDate IS NULL
                            AND d.Name IN ('Production', 'Engineering', 'Marketing')
                        ) 
                        
                        AS a
                        PIVOT
                        (
                            COUNT(BusinessEntityID)
                            FOR DepartmentName IN ([Production], [Engineering], [Marketing])
                        ) AS b
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_05.png" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-4-3 Zmiana wierszy na kolumny</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 40px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        FROM table_source
                        PIVOT ( aggregate_function ( value_column )
                        FOR pivot_column
                        IN ( &#x3C;column_list&#x3E;)
                        ) table_alias
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB   compact ">
        <h2>Argumenty PIVOT</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">table_source :</span> źródło danych do sworzenia (pivoted) </li>
            <li class="next"><span class="green">aggregate_function :</span> Funkcja użyta na poszczególnej kolumnie</li>
            <li class="next"><span class="green">value_column :</span> Ta kolumna będzie użyta w agregacji</li>
        </ol>
    </section>
    <section class="slide creamB   compact ">
        <h2>Argumenty PIVOT</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">pivot_column :</span>Columny które będą użyte do utworzenia nagłówka </li>
            <li class="next"><span class="green">column_list :</span> Wartości dla sworzenia z kolumny</li>
            <li class="next"><span class="green">table_alias :</span> Alias w tabelce</li>
        </ol>
    </section>



    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-4-4 Zmiana wierszy na kolumny</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 29px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 29px !important;">
                        SELECT s.Name AS ShiftName,
                            SUM(CASE WHEN d.Name = 'Production' THEN 1 ELSE 0 END) AS Production,
                            SUM(CASE WHEN d.Name = 'Engineering' THEN 1 ELSE 0 END) AS Engineering,
                            SUM(CASE WHEN d.Name = 'Marketing' THEN 1 ELSE 0 END) AS Marketing
                        FROM HumanResources.EmployeeDepartmentHistory h
                        INNER JOIN HumanResources.Department d
                        ON h.DepartmentID = d.DepartmentID
                        INNER JOIN HumanResources.Shift s
                        ON h.ShiftID = s.ShiftID
                        WHERE h.EndDate IS NULL
                        AND d.Name IN ('Production', 'Engineering', 'Marketing')
                        GROUP BY s.Name;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_05.png" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-5<br /><span>Zmiana wierszy na kolumny
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-5 Zmiana kolumn na wiersze</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        IF OBJECT_ID('tempdb.dbo.#Contact') IS NOT NULL DROP TABLE #Contact;
                        CREATE TABLE #Contact
                        (
                            EmployeeID INT NOT NULL,
                            PhoneNumber1 BIGINT,
                            PhoneNumber2 BIGINT,
                            PhoneNumber3 BIGINT
                        )
                        GO

                        INSERT #Contact
                        (EmployeeID, PhoneNumber1, PhoneNumber2, PhoneNumber3)
                        VALUES (1, 2718353881, 3385531980, 5324571342),
                        (2, 6007163571, 6875099415, 7756620787),
                        (3, 9439250939, NULL, NULL);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-5-2 Zmiana kolumn na wiersze</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 41px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 50px !important;">
                        SELECT EmployeeID,
                            [PhoneNumber1],
                            [PhoneNumber2],
							[PhoneNumber3]
                        FROM #Contact c
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_03-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-5-3 Zmiana kolumn na wiersze</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT EmployeeID,
                            PhoneType,
                            PhoneValue
                            FROM #Contact c
                        UNPIVOT
                        (
                            PhoneValue
                            FOR PhoneType IN ([PhoneNumber1], [PhoneNumber2], 
                            [PhoneNumber3])
                        ) AS p;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_04-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-5-4 Zmiana kolumn na wiersze</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT EmployeeID,
                        'PhoneNumber1' AS PhoneType,
                        c.PhoneNumber1 AS PhoneValue
                        FROM #Contact c
                        WHERE c.PhoneNumber1 IS NOT NULL
                        UNION ALL
                        SELECT EmployeeID,
                        'PhoneNumber2' AS PhoneType,
                        c.PhoneNumber2 AS PhoneValue
                        FROM #Contact c
                        WHERE c.PhoneNumber2 IS NOT NULL
                        UNION ALL
                        SELECT EmployeeID,
                        'PhoneNumber3' AS PhoneType,
                        c.PhoneNumber3 AS PhoneValue
                        FROM #Contact c
                        WHERE c.PhoneNumber3 IS NOT NULL
                        ORDER BY EmployeeID, PhoneType;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-6<br /><span>Używanie zapytań ponownie
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-6 Używanie zapytań ponownie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 31px !important;">
                        WITH cte AS
                        (
                            SELECT SalesOrderID
                            FROM Sales.SalesOrderDetail
                            WHERE UnitPrice BETWEEN 1900 AND 2000
                        )

                        SELECT s.PurchaseOrderNumber
                        FROM Sales.SalesOrderHeader s
                        WHERE EXISTS (SELECT SalesOrderID
                        FROM cte
                        WHERE SalesOrderID = s.SalesOrderID );
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_05-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-7-1 Używanie zapytań ponownie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 50px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 50px !important;">
                        WITH expression_name
                        [ ( column_name [ ,...n ] ) ] 
                        AS ( CTE_query_SELECT_definition )
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>Argumenty CTE</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">expression_name :</span> Nazwa wyrażenia common table expression</li>
            <li class="next"><span class="green">column_name[(n,a)] :</span> Unikalne nazwy kolumn. Nie  muszę ich podawać</li>
            <li class="next"><span class="green">CTE_query_SELECT_definition :</span> Zapytanie SELECT, które definuje common table expression</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-7-2 Używanie zapytań ponownie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 39px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 39px !important;">
                        WITH CTE(N, D) AS
                        (
                            SELECT TOP (5) object_id, type_desc
                            FROM sys.objects
                        )
                        SELECT N,D FROM CTE;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>Mamy dwa typy Common Table Expression</h2>
        <ol class="nonumbers">
            <li class="next">Rekurencyjne</li>
            <li class="next">Nie Rekurencyjne</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>CTE</h2>
        <ol class="nonumbers">
            <li class="next">Nie przechowuje rezultatu wywołania, kóre później może być wykorzystane ponownie</li>
        </ol>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-7-2 Używanie zapytań ponownie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 29px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 29px !important;">
                        WITH VendorSearch(RowNumber, VendorName, AccountNumber) AS
                        (
                            SELECT ROW_NUMBER() OVER (ORDER BY Name) RowNum,
                            Name,
                            AccountNumber
                            FROM Purchasing.Vendor
                        )

                        SELECT * FROM VendorSearch;
						SELECT * FROM VendorSearch;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_06.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">6-8<br /><span>Zapytania na tabelkach rekurecyjnych
        </span></span>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-8-1 Zapytania na tabelkach rekurecyjnych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        IF OBJECT_ID('tempdb.dbo.#Company') IS NOT NULL DROP TABLE #Company;
                        CREATE TABLE #Company
                        (
                            CompanyID INT NOT NULL
                            PRIMARY KEY,
                            ParentCompany ID INT NULL,
                            CompanyName VARCHAR(25) NOT NULL
                        );

                        INSERT #Company
                        (CompanyID, ParentCompanyID, CompanyName)
                        VALUES (1, NULL, 'A-Corp'),
                        (2, 1, 'B-Corp'),
                        (3, 1, 'C-Corp'),
                        (4, 3, 'D-Corp'),
                        (5, 4, 'F-Corp'),
                        (6, 5, 'E-Corp'),
                        (7, 5, 'G-Corp');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_06-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-8-2 Zapytania na tabelkach rekurecyjnych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 18px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 17px !important;">
                        WITH CompanyTree(ParentCompanyID, CompanyID, CompanyName, CompanyLevel) AS
                        (
                            -- Anchor Member
                            SELECT ParentCompanyID,
                            CompanyID,
                            CompanyName,
                            0 AS CompanyLevel
                            FROM #Company
                            WHERE ParentCompanyID IS NULL
                            UNION ALL
                            -- Recursive Member
                            SELECT c.ParentCompanyID,
                            c.CompanyID,
                            c.CompanyName,
                            p.CompanyLevel + 1
                            FROM #Company c
                            INNER JOIN CompanyTree p
                            ON c.ParentCompanyID = p.CompanyID
                        )

                        SELECT ParentCompanyID,
                        CompanyID,
                        CompanyName,
                        CompanyLevel
                        FROM CompanyTree;
                        option (maxrecursion 5)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>Głębia</h2>
        <ol class="nonumbers">
            <li class="next">Głębia rekursji domyślnie wynosi maksymalnie 100</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">6-6-3 Zapytania na tabelkach rekurecyjnych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 41px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT ParentCompanyID,
                        CompanyID,
                        CompanyName,
                        CompanyLevel
                        FROM CompanyTree
                        option (MaxRecursion  2)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
 
    <section class="slide creamP">
        <span class="shout colors"><span>7. Window function i słowo kluczowe OVER
        </span></span>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_08.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors " style="font-size: 190% !important;"><span>Window Function pozwala twojemu zapytaniu SQL spojrzeć na podzbiór wierszy,
            które są zwracane przez zapytanie zanim funkcja agregująca zadziała na te wiersze
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle">
                <h2 class="headerCODE">5-2 Grupowanie podstawy z groupby</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT AVG(Grade) AS AvgGrade,
                        AVG(DISTINCT Grade) AS AvgDistinctGrade,
                        MAX(Grade) AS MaxGrade,
                        MIN(Grade) AS MinGrade
                        FROM (VALUES (1, 100),
                        (1, 99),
                        (1, 99),
                        (1, 98),
                        (1, 99),
                        (1, 32),
                        (2, 77),
                        (2, 56),
                        (2, 88),
                        (2, 60),
                        (2, 80)
                        ) dt (StudentId, Grade)
            
                        GROUP BY StudentId
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>

    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-01.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle">
                <h2 class="headerCODE">7-0-0 Grupowanie podstawy z groupby</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT 
                        StudentId,Grade
                        FROM (VALUES (1, 100),
                       (1, 99),
                       (1, 99),
                       (1, 98),
                       (1, 99),
                       (1, 32),
                       (2, 77),
                       (2, 56),
                       (2, 88),
                       (2, 60),
                       (2, 80)
                       ) dt (StudentId, Grade)
                                   
                       GROUP BY StudentId
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle">
                <h2 class="headerCODE">7-0-0 Grupowanie podstawy z groupby</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT 
                        StudentId,
                        AVG(Grade) OVER (ORDER BY StudentId) 
                        FROM (VALUES (1, 100),
                        (1, 99),
                        (1, 99),
                        (1, 98),
                        (1, 99),
                        (1, 32),
                        (2, 77),
                        (2, 22),
                        (2, 88),
                        (2, 60),
                        (2, 80)
                        ) dt (StudentId, Grade)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-03.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle">
                <h2 class="headerCODE">7-0-0 Grupowanie podstawy z groupby</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT 
                        Distinct StudentId,
                        AVG(Grade) OVER (ORDER BY StudentId) 
                        FROM (VALUES (1, 100),
                        (1, 99),
                        (1, 99),
                        (1, 98),
                        (1, 99),
                        (1, 32),
                        (2, 77),
                        (2, 22),
                        (2, 88),
                        (2, 60),
                        (2, 80)
                        ) dt (StudentId, Grade)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_09.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors " style="font-size: 190% !important;"><span>Dodajmy więcej studentów bo nic z tego okna nie widać
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle">
                <h2 class="headerCODE">7-0-0 Grupowanie podstawy z groupby</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT 
                        StudentId,
                        AVG(Grade) OVER (ORDER BY StudentId) 
                        FROM (VALUES (11, 100),
                        (1, 99),
                        (2, 99),
                        (3, 98),
                        (4, 99),
                        (5, 32),
                        (6, 77),
                        (7, 22),
                        (8, 88),
                        (9, 60),
                        (10, 80)
                        ) dt (StudentId, Grade)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-04.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors " style="font-size: 190% !important;"><span>Window Function pozwala twojemu zapytaniu SQL spojrzeć na podzbiór wierszy,
            które są zwracane przez zapytanie zanim funkcja agregująca zadziała na te wiersze
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"  style="font-size: 190% !important;"><span>W ten sposób funkcje pozwalają tobie określeć odpowiednią kolejność danych, które mają trafić do pewnej operacji<span>
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-0 PRZYKŁAD</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 40px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT duration_seconds,
                        SUM(duration_seconds) OVER 
                        (ORDER BY id) 
                        AS running_total
                        FROM [demo].[dbo].[Runinng]
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_11.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-0 PRZYKŁAD</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 40px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT duration_seconds,
                        SUM(duration_seconds) OVER 
                        (ORDER BY  id DESC)
                        AS running_total
                        FROM [demo].[dbo].[Runinng]
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_12.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Lepsze to niż : self-join czy iterację po pętli
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"  style="font-size: 190% !important;"><span>Window Function pozwala tobie kontrolować kolejność danych które mają trafić do funkcji agregującej
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Jakie funkcje agregujące mogą być wykonane ze słowem OVER</h2>
        <ol class="nonumbers">
            <li class="next">AVG, CHECKSUM-AGG, COUNT, COUNT_BIG, MAX, MIN,</li>
            <li class="next">STDEV, STDEVP, SUM, VAR, VARP</li>
        </ol>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Są jeszcze funkcje rankingowe
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next">ROW_NUMBER, RANK</li>
            <li class="next">DENSE_RANK, NTILE</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle">
                <h2 class="headerCODE">7-0-0 Grupowanie podstawy z groupby</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT 
                        StudentId,
                        RANK()  OVER (ORDER BY Grade) AS RANK,
                        DENSE_RANK() OVER (ORDER BY Grade) AS DENSE_RANK,
                        ROW_NUMBER() OVER (ORDER BY Grade) AS ROW_NUMBER,
                        AVG(Grade) OVER (ORDER BY Grade) AS AVGGrade
                        FROM (VALUES (11, 100),
                        (1, 99),
                        (2, 99),
                        (3, 98),
                        (4, 99),
                        (5, 32),
                        (6, 77),
                        (7, 22),
                        (8, 88),
                        (9, 60),
                        (10, 80)
                        ) dt (StudentId, Grade)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-05.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_13.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB  compact">
        <h2>Funkcje analityczne, a Offset functions</h2>
        <ol class="nonumbers">
            <li class="next">LAG, LEAD</li>
            <li class="next">FIRST_VALUE, i LAST_VALUE</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle">
                <h2 class="headerCODE">5-2 Grupowanie podstawy z groupby</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT 
                        StudentId,
                        LAG(Grade,1)  OVER (ORDER BY Grade) AS PreviousGrade,
                        LEAD(Grade,1) OVER (ORDER BY Grade) AS NextGrade,
                        FIRST_VALUE(Grade) OVER (ORDER BY Grade) AS FirstGrade,
                        LAST_VALUE(Grade)  OVER (ORDER BY Grade) AS LastGrade
                        FROM (VALUES (11, 100),
                        (1, 99),
                        (2, 99),
                        (3, 98),
                        (4, 99),
                        (5, 32),
                        (6, 77),
                        (7, 22),
                        (8, 88),
                        (9, 60),
                        (10, 80)
                        ) dt (StudentId, Grade)
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>

    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-06.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-1<br /><span>Kalkulacje na podstawie kolejności wierszy
        </span></span>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-1 Kalkulacje na podstawie kolejności wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 21px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 21px !important;">

                        CREATE TABLE #Transactions
                        (
                            AccountId INTEGER,
                            TranDate DATE,
                            TranAmt NUMERIC(8, 2)
                        );
                        INSERT INTO #Transactions
                        SELECT *
                        FROM ( VALUES 
                        ( 1, '2011-01-01', 500),
                        ( 1, '2011-01-15', 50),
                        ( 1, '2011-01-22', 250),
                        ( 1, '2011-01-24', 75),
                        ( 1, '2011-01-26', 125),
                        ( 1, '2011-01-26', 175),
                        ( 2, '2011-01-01', 500),
                        ( 2, '2011-01-15', 50),
                        ( 2, '2011-01-22', 25),
                        ( 3, '2011-01-22', 5000),
                        ( 3, '2011-01-27', 550),
                        ( 3, '2011-01-27', 95 ),
                        ( 3, '2011-01-30', 2500)
                        ) dt (AccountId, TranDate, TranAmt);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-1-1 Kalkulacje na podstawie kolejności wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,
                        -- Suma dla wszystkich transakcji według daty 
                        -- i podzielona/resetowana przez AccountId
                        RunTotalAmt = SUM(TranAmt) 
                        OVER (PARTITION BY AccountId ORDER BY TranDate)
                        FROM #Transactions AS t
                        ORDER BY AccountId,
                        TranDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_08-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-067.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-1-2 Kalkulacje na podstawie kolejności wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,
                        -- Suma dla wszystkich transakcji według daty
                        RunTotalAmt = SUM(TranAmt) 
                        OVER (ORDER BY TranDate)
                        FROM #Transactions AS t
                        ORDER BY 
                        RunTotalAmt;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-07.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-1-3 Kalkulacje na podstawie kolejności wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,
                        -- Suma dla wszystkich transakcji według daty
                        RunTotalAmt = SUM(TranAmt) OVER (PARTITION BY AccountId ORDER BY TranDate),
                        -- Suma dla wszystkich transakcji według daty 
                        -- (jeżeli są dwie takie same daty to nie łączymy)
                        RunTotalAmt2 = SUM(TranAmt) OVER (PARTITION BY AccountId
                        ORDER BY TranDate
                        ROWS UNBOUNDED PRECEDING)
                        FROM #Transactions AS t
                        ORDER BY AccountId,
                        TranDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-1-4 Przykład</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        OVER (
                            [ &#x3C;PARTITION BY clause&#x3E; ]
                            [ &#x3C;ORDER BY clause&#x3E; ]
                            [ &#x3C;ROW or RANGE clause&#x3E; ]
                        )
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-08.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_14.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-1-3 Kalkulacje na podstawie kolejności wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 21px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 20px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,
        
                        RunAvg = AVG(TranAmt) OVER (PARTITION BY AccountId ORDER BY TranDate),
                      
                        RunTranQty = COUNT(*) OVER (PARTITION BY AccountId ORDER BY TranDate),
              
                        RunSmallAmt = MIN(TranAmt) OVER (PARTITION BY AccountId ORDER BY TranDate),
            
                        RunLargeAmt = MAX(TranAmt) OVER (PARTITION BY AccountId ORDER BY TranDate),
          
                        RunTotalAmt = SUM(TranAmt) OVER (PARTITION BY AccountId ORDER BY TranDate)

                        FROM #Transactions AS t
                        WHERE AccountID = 1
                        ORDER BY AccountId, TranDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-09.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-2<br /><span>Kalkulacje na obecnym wierszu i dwówch poprzednich
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-2-0 Przykład</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        OVER (
                            [ &#x3C;PARTITION BY clause&#x3E; ]
                            [ &#x3C;ORDER BY clause&#x3E; ]
                            [ &#x3C;ROW or RANGE clause&#x3E; ]
                        )
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-2 Kalkulacje na obecnym wierszu i dwówch poprzednich</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,

                        -- Liczba # obecnych i poprzednich 2 transakcji
                        SlideQty = COUNT(*)
                        OVER (PARTITION BY AccountId
                        ORDER BY TranDate
                        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW),

                        -- Suma obecna i poprzednich 2 transakcji
                        SlideTotal = SUM(TranAmt)
                        OVER (PARTITION BY AccountId
                        ORDER BY TranDate
                        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW)

                        FROM #Transactions AS t
                        ORDER BY AccountId, TranDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-10.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_15.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>

    <section class="slide creamB">
        <span class="shout colors">7-3<br /><span>Kalkulacje na podstawie procentu całości
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-3 Kalkulacje na podstawie procentu całości</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 38px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 38px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,

                        AccountTotal = SUM(TranAmt) 
                        OVER (PARTITION BY AccountId),

                        AmountPct = TranAmt / SUM(TranAmt) 
                        OVER (PARTITION BY t.AccountId)

                        FROM #Transactions AS t
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_10-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-4<br /><span>Kalkulacje na X-obecny wierszy i Y-wszystkich wierszy
        </span></span>
    </section>


    <section class="slide creamB  compact">
        <h2>Ranking functions : Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">ROW_NUMBER:</span> Zwraca liczbę całkowitą która rośnie wraz z liczbą wierszy. Zaczynajac od 1</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-4 Kalkulacje na X-obecny wierszy i Y-wszystkich wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 20px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 30px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,
                        -- KolejnyWierszPo AccountId
                        KolejnyWierszPoId = ROW_NUMBER() OVER (PARTITION BY AccountId ORDER BY AccountId, TranDate),
                        -- KolejnyWierszPo Wszystkim
                        KolejnyWierszPoWszystkich = COUNT(*) OVER (PARTITION BY AccountId),
                        -- KolejnyWierszPo IdWiersza
                        IdWiersza = ROW_NUMBER() OVER (ORDER BY AccountId, TranDate),
                        WszystkieWiersze = COUNT(*) OVER ()
                        FROM #Transactions AS t
                        ORDER BY AccountId, TranDate;;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_11-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-6<br /><span>Generowanie kolumny z liczbą wierszy
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-6 Generowanie kolumny z liczbą wierszy </h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT TOP 10
                        AccountNumber,
                        OrderDate,
                        TotalDue,

                        ROW_NUMBER() OVER 
                        (PARTITION BY AccountNumber ORDER BY OrderDate) 
                        AS RowNumber

                        FROM AdventureWorks2014.Sales.SalesOrderHeader
                        ORDER BY AccountNumber;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_12-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-6<br /><span>Użycie logicznego Okna
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-7 Użycie logicznego Okna</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 26px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 26x !important;">

                        CREATE TABLE #Test
                        (
                            RowID INT IDENTITY,
                            FName VARCHAR(20),
                            Salary SMALLINT
                        );
                        INSERT INTO #Test (FName, Salary)
                        VALUES ('Adam', 800),
                        ('Stefan', 950),
                        ('Nosal', 1250),
                        ('Kalina', 1250), --<< powtórzenie
                        ('Patrycja', 1300),
                        ('Bartek', 1500),
                        ('Tomek', 1600),
                        ('Franek', 3000),
                        ('Cezary', 3000), --<< powtórzenie
                        ('Cezaryna', 5000);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>Framing options</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">ROWS :</span> od wierszy</li>
            <li class="next"><span class="green">RANGE :</span> od zakresu wartości</li>
            <li class="next"><span class="green">UNBOUNDED PRECEDING :</span>wszystkie rekordy od początku ramki</li>
        </ol>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-7-1 Użycie logicznego Okna</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 29px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 29px !important;">
                        SELECT RowID,
                        FName,
                        Salary,
                        SumByRows = SUM(Salary) 
                        OVER (ORDER BY Salary ROWS UNBOUNDED PRECEDING),
                        SumByRange = SUM(Salary) 
                        OVER (ORDER BY Salary RANGE UNBOUNDED PRECEDING)
                        FROM #Test
                        ORDER BY RowID;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-11.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-8<br /><span>Zwracanie wierszy poprzez ich range
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Ranking functions : Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">RANK :</span> Podobne do Row_NUMBER() jednakże jeżeli napotkamy taką samą wartość w partycji to wartość pozostaje taka sama. 
                Jednakże następna wartość będzie już zinkremetowana po powtarzalnych wartościach
            </li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Ranking functions : Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">DENSE_RANK :</span> Podobne do Row_NUMBER() jednakże jeżeli napotkamy taką samą wartość w partycji to wartość pozostaje taka sama. 
                Jednakże następna wartość będzie już zinkremetowana</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Ranking functions : Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">NTILE :</span> NTILE dzieli rezultat na spefyciczne ponumerowane grupy bazujące na kolejności opcjonalnego wyrażenia ORDER</li>
        </ol>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-8 Zwracanie wierszy poprzez ich range </h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 26px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT BusinessEntityID,
                        SalesQuota,
                        RANK() OVER (ORDER BY SalesQuota DESC) AS RankWithGaps,
                        DENSE_RANK() OVER (ORDER BY SalesQuota DESC) AS RankWithoutGaps,
                        ROW_NUMBER() OVER (ORDER BY SalesQuota DESC) AS RowNumber
                        FROM Sales.SalesPersonQuotaHistory
                        WHERE QuotaDate = '2014-03-01'
                        AND SalesQuota < 500000;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-12.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-8<br /><span>Sortowanie rekordów do podgrup : podziel sprzedaże na 4 grupy
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Ranking functions : Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">NTILE :</span> NTILE dzieli rezultat na spefyciczne ponumerowane grupy bazujące na kolejności opcjonalnego wyrażenia ORDER</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Ranking functions : Funkcje rankingowe</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">NTILE :</span> czyli służy do podziału elementów na n-tyle (np. NTILE(4) = kwartyle ).</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-8 Sortowanie rekordów do podgrup : podziel sprzedaże na 4 grupy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT BusinessEntityID,
                        QuotaDate,
                        SalesQuota,
                        NTILE(4) OVER (ORDER BY SalesQuota DESC) AS [NTILE]
                        FROM Sales.SalesPersonQuotaHistory
                        WHERE SalesQuota BETWEEN 266000.00 AND 319000.00;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_15-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-8-1 Sortowanie rekordów do podgrup : podziel sprzedaże na 4 grupy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 29px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SELECT AccountId,
                        TranDate,
                        TranAmt,
						NTILE(4) OVER (ORDER BY TranAmt DESC) AS [NTILE]
                        FROM #Transactions AS t
                        ORDER BY [NTILE],
                        TranDate;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-14.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-9<br /><span>Znajdowanie luk
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Funkcje analityczne, a Offset functions</h2>
        <ol class="nonumbers">
            <li class="next">LAG, LEAD</li>
            <li class="next">FIRST_VALUE, i LAST_VALUE</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Analytic functions : Funkcje analityczne</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">LEAD :</span> Pobiera dane z kolejnego wiersza </li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-9 Znajdowanie luk</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 20px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 20px !important;">
                        CREATE TABLE #Gaps (col1 INTEGER PRIMARY KEY CLUSTERED);

                        INSERT INTO #Gaps (col1)
                        VALUES (1), (2), (3),
                        (50), (51), (52), (53), (54), (55),
                        (100), (101), (102),
                        (500),
                        (950), (951), (952),
                        (954);

                        WITH cte AS
                        (
                            SELECT col1 AS CurrentRow,
                            LEAD(col1, 1, NULL) OVER (ORDER BY col1) AS NextRow
                            FROM #Gaps
                        )

                        -- Compare the value of the current row to the next row.
                        -- If > 1, then there is a gap.
                        SELECT cte.CurrentRow + 1 AS [Start of Gap],
                        cte.NextRow - 1 AS [End of Gap]
                        FROM cte
                        WHERE cte.NextRow - cte.CurrentRow > 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>


    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_16-SQL.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">7-10<br /><span>Porównanie danych z poprzedniego miesiąca
        </span></span>
    </section>

    <section class="slide creamB  compact">
        <h2>Analytic functions : Funkcje analityczne</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">LAG :</span> Pobiera danych w poprzedniego wiersza </li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-10 Lag example</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 21px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 20px !important;">
                        WITH cte_netsales_2018 AS(
                            SELECT 
                                month, 
                                SUM(net_sales) net_sales
                            FROM 
                                sales.vw_netsales_brands
                            WHERE 
                                year = 2018
                            GROUP BY 
                                month
                        )

                        SELECT 
                            month,
                            net_sales,
                            LAG(net_sales,1) OVER (
                                ORDER BY month
                            ) previous_month_sales
                        FROM 
                            cte_netsales_2018;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide creamB">
        <span class="shout colors">7-11<br /><span>Pobieranie pierwszej i ostatniej wartośći z partycji
        </span></span>
    </section>

    <section class="slide creamB  compact">
        <h2>Analytic functions : Funkcje analityczne</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">FIRST_VALUE :</span> Pobiera dane z pierwszego wiersza </li>
            <li class="next"><span class="green">LAST_VALUE :</span> Pobiera dane z ostatniego wiersza </li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-11 Pobieranie pierwszej i ostatniej wartośći z partycji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 22px !important;">
                        SELECT DISTINCT TOP (5)
                        CustomerID,
                        -- Get the date for the customer's least expensive order
                        FIRST_VALUE(OrderDate)
                        OVER (PARTITION BY CustomerID
                        ORDER BY TotalDue
                        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS OrderDateLow,
                        -- Get the date for the customer's most expensive order
                        LAST_VALUE(OrderDate)
                        OVER (PARTITION BY CustomerID
                        ORDER BY TotalDue
                        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS OrderDateHigh
                        FROM Sales.SalesOrderHeader
                        ORDER BY CustomerID;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/example-15.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>

    <!-- <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-9 Grupowanie logiczne kolejne wiersze razem</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 15px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 16px !important;">
                        CREATE TABLE #RFID_Location (
                            TagId INTEGER,
                            Location VARCHAR(25),
                            SensorReadTime DATETIME);
                            INSERT INTO #RFID_Location
                            (TagId, Location, SensorReadTime)
                            VALUES (1, 'Room1', '2012-01-10T08:00:01'),
                            (1, 'Room1', '2012-01-10T08:18:32'),
                            (1, 'Room2', '2012-01-10T08:25:42'),
                            (1, 'Room3', '2012-01-10T09:52:48'),
                            (1, 'Room2', '2012-01-10T10:05:22'),
                            (1, 'Room3', '2012-01-10T11:22:15'),
                            (1, 'Room4', '2012-01-10T14:18:58'),
                            (2, 'Room1', '2012-01-10T08:32:18'),
                            (2, 'Room1', '2012-01-10T08:51:53'),
                            (2, 'Room2', '2012-01-10T09:22:09'),
                            (2, 'Room1', '2012-01-10T09:42:17'),
                            (2, 'Room1', '2012-01-10T09:59:16'),
                            (2, 'Room2', '2012-01-10T10:35:18'),
                            (2, 'Room3', '2012-01-10T11:18:42'),
                            (2, 'Room4', '2012-01-10T15:22:18');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-9 Grupowanie logiczne kolejne wiersze razem</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 20px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 21px !important;">
                        WITH cte AS
                        (
                            SELECT TagId, Location, SensorReadTime,
                            ROW_NUMBER() OVER (PARTITION BY TagId ORDER BY SensorReadTime) -
                            ROW_NUMBER() OVER (PARTITION BY TagId, Location ORDER BY SensorReadTime) AS Grp
                            FROM #RFID_Location
                        )
                        SELECT TagId, Location, SensorReadTime, Grp,
                        DENSE_RANK() OVER (PARTITION BY TagId, Location ORDER BY Grp) AS TripNbr
                        FROM cte
                        ORDER BY TagId, SensorReadTime;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section> -->

    <!-- <section class="slide creamB  compact">
        <h2>Analytic functions : Funkcje analityczne</h2>
        <ol class="nonumbers">
            <li class="next">CUME_DIST : </li>
            <li class="next">FIRST_VALUE</li>
            <li class="next">LAG</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Analytic functions : Funkcje analityczne</h2>
        <ol class="nonumbers">
            <li class="next">LAST_VALUE</li>
            <li class="next">LEAD</li>
            <li class="next">PERCENTILE_CONT</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Analytic functions : Funkcje analityczne</h2>
        <ol class="nonumbers">
            <li class="next">PERCENTILE_DISC</li>
            <li class="next">PERCENT_RANK</li>
        </ol>
    </section> -->


<!-- 

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-10 Uzyskanie dostępu do innych wierszy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 23px !important;">
                        WITH cte AS
                        (
                        -- Break the OrderDate down into the Year and Quarter
                        SELECT DATEPART(QUARTER, OrderDate) AS Qtr,
                        DATEPART(YEAR, OrderDate) AS Yr,
                        TotalDue
                        FROM Sales.SalesOrderHeader
                        ), cteAgg AS
                        (
                        -- Aggregate the TotalDue, Grouping on Year and Quarter
                        SELECT Yr,
                        Qtr,
                        SUM(TotalDue) AS TotalDue
                        FROM cte
                        GROUP BY Yr, Qtr
                        )
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-11 Znajdowanie pustych wartości w sekwencjach liczbowych</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 23px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 24px !important;">
                        CREATE TABLE #Gaps (col1 INTEGER PRIMARY KEY CLUSTERED);
                        INSERT INTO #Gaps (col1)
                        VALUES (1), (2), (3),
                        (50), (51), (52), (53), (54), (55),
                        (100), (101), (102),
                        (500),
                        (950), (951), (952),
                        (954);
                        -- Compare the value of the current row to the next row.
                        -- If > 1, then there is a gap.
                        WITH cte AS
                        (
                        SELECT col1 AS CurrentRow,
                        LEAD(col1, 1, NULL) OVER (ORDER BY col1) AS NextRow
                        FROM #Gaps
                        )
                        SELECT cte.CurrentRow + 1 AS [Start of Gap],
                        cte.NextRow - 1 AS [End of Gap]
                        FROM cte
                        WHERE cte.NextRow - cte.CurrentRow > 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-12-2 Poibieranie pierwszej i ostatniej wartośći z partycji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT CustomerID, TotalDue, OrderDate
                        FROM Sales.SalesOrderHeader
                        WHERE CustomerID = 11000
                        ORDER BY TotalDue;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-13 Kalkulowanie relatywnej pozycji lub rankingu  wartości wewnątrz zbioru wartości</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        SELECT CustomerID,
                        TotalDue,
                        CUME_DIST()
                        OVER (PARTITION BY CustomerID
                        ORDER BY TotalDue) AS CumeDistOrderTotalDue,
                        PERCENT_RANK()
                        OVER (PARTITION BY CustomerID
                        ORDER BY TotalDue) AS PercentRankOrderTotalDue
                        FROM Sales.SalesOrderHeader
                        WHERE CustomerID IN (11439, 30116)
                        ORDER BY CustomerID, TotalDue;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-14 Kalkulowanie relatywnej pozytcji lub rankingu  wartości wewnątrz zbioru wartości</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        DECLARE @Employees TABLE
                        (
                            EmplId INT PRIMARY KEY CLUSTERED,
                            DeptId INT,
                            Salary NUMERIC(8, 2)
                        );
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-14 Kalkulowanie relatywnej pozytcji lub rankingu  wartości wewnątrz zbioru wartości</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 31px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 40px !important;">
                        INSERT INTO @Employees
                        VALUES (1, 1, 10000),
                        (2, 1, 11000),
                        (3, 1, 12000),
                        (4, 2, 25000),
                        (5, 2, 35000),
                        (6, 2, 75000),
                        (7, 2, 100000);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-14 Kalkulowanie relatywnej pozytcji lub rankingu  wartości wewnątrz zbioru wartości</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 22px !important;">
                        SELECT EmplId,
                        DeptId,
                        Salary,
                        PERCENTILE_CONT(0.5)
                        WITHIN GROUP (ORDER BY Salary ASC)
                        OVER (PARTITION BY DeptId) AS MedianCont,
                        PERCENTILE_DISC(0.5)
                        WITHIN GROUP (ORDER BY Salary ASC)
                        OVER (PARTITION BY DeptId) AS MedianDisc,
                        PERCENTILE_CONT(0.75)
                        WITHIN GROUP (ORDER BY Salary ASC)
                        OVER (PARTITION BY DeptId) AS Percent75Cont,
                        PERCENTILE_DISC(0.75)
                        WITHIN GROUP (ORDER BY Salary ASC)
                        OVER (PARTITION BY DeptId) AS Percent75Disc,
                        CUME_DIST()
                        OVER (PARTITION BY DeptId
                        ORDER BY Salary) AS CumeDist
                        FROM @Employees
                        ORDER BY DeptId, EmplId;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-15 Przypisywanie sekwencji do specyficznej kolejności</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 22px !important;">
                        IF EXISTS (SELECT *
                        FROM sys.sequences AS seq
                        JOIN sys.schemas AS sch
                        ON seq.schema_id = sch.schema_id
                        WHERE sch.name = 'dbo'
                        AND seq.name = 'CH7Sequence')
                        DROP SEQUENCE dbo.CH7Sequence;
                        CREATE SEQUENCE dbo.CH7Sequence AS INTEGER START WITH 1;
                        DECLARE @ClassRank TABLE
                        (
                        StudentID TINYINT,
                        Grade TINYINT,
                        SeqNbr INTEGER
                        );
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">7-15 Przypisywanie sekwencji do specyficznej kolejności</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 22px !important;">
                        INSERT INTO @ClassRank (StudentId, Grade, SeqNbr)
                        SELECT StudentId,
                        Grade,
                        NEXT VALUE FOR dbo.CH7Sequence OVER (ORDER BY Grade ASC)
                        FROM (VALUES (1, 100),
                        (2, 95),
                        (3, 85),
                        (4, 100),
                        (5, 99),
                        (6, 98),
                        (7, 95),
                        (8, 90),
                        (9, 89),
                        (10, 89),
                        (11, 85),
                        (12, 82)) dt(StudentId, Grade);
                        SELECT StudentId, Grade, SeqNbr
                        FROM @ClassRank;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section> -->

    <section class="slide creamP">
        <span class="shout colors"><span>8. Transakcje, Blokady i DeadLocki
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Transakcje. Zasada ACID</h2>
        <ol class="nonumbers">
            <li class="next">Atomicity : Transakcje działają na zasadzie wszystko, albo nic</li>
            <li class="next">Consistency : Dane są prawidłowe przed i po transakcji</li>
            <li class="next">Isolation : Transakcja nie jest zależna od innych transakcji</li>
            <li class="next">Durability : Zmiana istnieje po zatwierdzeniu działania</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Swoją drogą  istnieje możliwość wyłączenia 
            NIEJAWNYCH transakcji dla poleceń</h2>
        <ol class="nonumbers">
            <li class="next">ALTER TABLE, FETCH, REVOKE, CREATE, </li>
                <li class="next">GRANT, SELECT, DELETE,
                    INSERT, TRUNCATE TABLE</li>
                    <li class="next">DROP, OPEN, and UPDATE</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-0</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">
                        SET IMPLICIT_TRANSACTIONS ON;
                        
                        SET IMPLICIT_TRANSACTIONS OFF;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Jawne transakcje są lepsze
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Polecenia transakcyjne</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">BEGIN TRANSACTION :</span> punkt startowy transakcji</li>
            <li class="next"><span class="green">ROLLBACK TRANSACTION :</span> cofnięcie wszystkich operacji wewnątrz transakcji</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Polecenia transakcyjne</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">COMMIT TRANSACTION : </span>potwierdź transakcje </li>
            <li class="next"><span class="green">BEGIN DISTRIBUTED
                TRANSACTION :</span> rozpoczniji transakcje dla wielu serwerów przy użyciu Microsoft Distributed Transaction Coordinator</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Polecenia transakcyjne</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">SAVE TRANSACTION :</span> zapisz punkt transakcji do którego można wrócić</li>
            <li class="next"><span class="green">@@TRANCOUNT :</span> zwraca liczbę aktywnych transakcji</li>
        </ol>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-1<br /><span>Używanie jawnych transakcji
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-1 Używanie jawnych transakcji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 15px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 15px !important;">
                        /* -- Przed Liczeniem */
                        SELECT BeforeCount = COUNT(*)
                        FROM HumanResources.Department;

                        /* -- Zmienna będzie przetrzymywać ostatni błąd */
                        DECLARE @Error int;
                        BEGIN TRANSACTION
                        INSERT INTO HumanResources.Department (Name, GroupName)
                        VALUES ('Accounts Payable', 'Accounting');
                        SET @Error = @@ERROR;
                        IF (@Error<> 0)
                        GOTO Error_Handler;

                        INSERT INTO HumanResources.Department (Name, GroupName)
                        VALUES ('Engineering', 'Research and Development');
                        SET @Error = @@ERROR;
                        IF (@Error <> 0)
                        GOTO Error_Handler;
                        COMMIT TRANSACTION

                        Error_Handler:
                        IF @Error <> 0
                        BEGIN
                            ROLLBACK TRANSACTION;
                        END

                        /* -- Po */
                        SELECT AfterCount = COUNT(*)
                        FROM HumanResources.Department;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-2<br /><span>Wyświetlanie najstarszej transakcji
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-2 Wyświetlanie najstarszej transakcji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">

                        USE AdventureWorks2014;
                        GO
                        BEGIN TRANSACTION
                        DELETE Production.ProductProductPhoto
                        WHERE ProductID = 317;

                        DBCC OPENTRAN('AdventureWorks2014');

                        ROLLBACK TRANSACTION;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/trans_01.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-3<br /><span>Pytanie o transakcje w czasie sesji
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-3 Pytanie o transakcje w czasie sesji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        --stwórzmy celowo trasakcje która nie jest zamknięta

                        SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
                        GO
                        USE AdventureWorks2014;
                        GO

                        BEGIN TRAN
                        SELECT *
                        FROM HumanResources.Department
                        INSERT INTO HumanResources.Department (Name, GroupName)
                        VALUES ('Test', 'QA');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_tanz_01.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-3-1 Pytanie o transakcje w czasie sesji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w innym oknie query
                        SELECT session_id, transaction_id, is_user_transaction, is_local
                        FROM sys.dm_tran_session_transactions
                        WHERE is_user_transaction = 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_tanz_02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-3-2 Pytanie o transakcje w czasie sesji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w innym oknie query
                        SELECT s.text
                        FROM sys.dm_exec_connections c
                        CROSS APPLY sys.dm_exec_sql_text(c.most_recent_sql_handle) s
                        WHERE c.most_recent_session_id = 51;
                        --użyj session_id zwrócone przez poprzednie zapytanie
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_tanz_03.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-3-3 Pytanie o transakcje w czasie sesji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 18px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 18px !important;">
                        --w innym oknie query
                        SELECT transaction_begin_time
                        ,tran_type = CASE transaction_type
                        WHEN 1 THEN 'Read/write transaction'
                        WHEN 2 THEN 'Read-only transaction'
                        WHEN 3 THEN 'System transaction'
                        WHEN 4 THEN 'Distributed transaction'
                        END
                        ,tran_state = CASE transaction_state
                        WHEN 0 THEN 'not been completely initialized yet'
                        WHEN 1 THEN 'initialized but has not started'
                        WHEN 2 THEN 'active'
                        WHEN 3 THEN 'ended (read-only transaction)'
                        WHEN 4 THEN 'commit initiated for distributed transaction'
                        WHEN 5 THEN 'transaction prepared and waiting resolution'
                        WHEN 6 THEN 'committed'
                        WHEN 7 THEN 'being rolled back'
                        WHEN 8 THEN 'been rolled back'
                        END
                        FROM sys.dm_tran_active_transactions
                        WHERE transaction_id = 12969598; 
                        -- zmień wartość transaction_id 
                        GO
                        
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_tanz_04.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-3-4 Pytanie o transakcje w czasie sesji</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --stwórzmy celowo trazakcje która nie jest zamknięta

                        --SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
                        --GO
                        --USE AdventureWorks2014;
                        --GO

                        --BEGIN TRAN
                        --SELECT *
                        --FROM HumanResources.Department
                        --INSERT INTO HumanResources.Department (Name, GroupName)
                        --VALUES ('Test', 'QA'); -->
                        
                        ROLLBACK TRANSACTION;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-4<br /><span>Zobaczmy aktywność blokującą
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Locking</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Shared lock :</span>Dane mogą być odczytane, ale niezmienione gdy ten lock istnieje</li>
            <li class="next"><span class="green">Intent lock :</span> Tworzy on kolejkę która ustala kolejność połączeń jak ich prawa do odczytu i zapisu</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Locking</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Update lock :</span> Jeżeli jest modyfikacja ten lock staje się Exclusive lock. Jeżeli tak nie jest to staje się on Shared Lock</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Locking</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Exclusive lock :</span> Blokuje on jakikolwiek dostęp. Może on działać niejawnie przy INSET,DELETE, UPDATE</li>
            <li class="next"><span class="green">Schema modification :</span> Lock gdy modyfikujesz schemat tabelki</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Locking</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Key-range :</span> Lock blokujący wybrany zakres rekordów bazując na kluczu. Jeżeli robisz UPDATE między rokiem 2011-2012 to te rekordy będą zablokowane</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Locking</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Schema stability :</span> Lock który się tworzy w trakcie kompilacji zapytania. Blokuje on zmiany schemy na tabelce</li>
            <li class="next"><span class="green">Bulk update :</span> Lock dla dużych operacji kopiowania. Operacje te są szybkie, ale redukują one współbieżność w danej tabeli</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Lock Resources</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Allocation unit :</span> Zbiory pages</li>
            <li class="next"><span class="green">Application :</span> Zasób określony przez aplikacje</li>
            <li class="next"><span class="green">Database :</span> całą bazę danych</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Lock Resources</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Extent :</span> Alokacja 8 przyległych 8KB danych lub index pages</li>
            <li class="next"><span class="green">File :</span> Cały plik bazo danowy</li>
            <li class="next"><span class="green">HOBT :</span> Sterta (tabela bez clustered index czy b-tree)</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Lock Resources</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Metadata :</span> System metadanych</li>
            <li class="next"><span class="green">Object :</span> Objekt w bazie danych (tabelka,widok, procedura, funkcja) </li>
            <li class="next"><span class="green">Page :</span> 8kb blok danych albo page index</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Lock Resources</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Key :</span> Blokowanie wierszy tak aby nie było fantomowych odczytów. Zwany również jako key-range-lock</li>
            <li class="next"><span class="green">Table :</span> Tabelka</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Lock Resources</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">RID :</span> Blokowanie wiersza</li>
        </ol>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Nie wszystkie locki są kompatybilne między sobą.
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Inny lock nie może zostać umieszczony gdy zasób ma na sobie lock exclusive
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Inne transakcje muszą czekać bądź dostać timeout aby exclusive lock został zwoliony<span>
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Jak to działa?
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Jak to działa?</h2>
        <ol class="nonumbers">
            <li class="next">Locki zajmują przestrzeń w pamięci</li>
            <li class="next">Jeśli pamięci nam zabraknie to wtedy SQL Server konwertuje wiele locków na jeden duży</li>
            <li class="next">Cierpi na tym współbieżność</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Jak to działa?</h2>
        <ol class="nonumbers">
            <li class="next">Możesz zablokować eskalację lock lub ustawić jego poziom</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-4 Zobaczyć Aktywność blokująca</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --stwórzmy celowo trazakcje która nie jest zamknięta

                        USE AdventureWorks2014;
                        BEGIN TRAN
                        SELECT ProductID, ModifiedDate
                        FROM Production.ProductDocument WITH (TABLOCKX);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-4-1 Zobaczyć Aktywność blokująca</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w drugim oknie

                        SELECT sessionid = request_session_id ,
                        ResType = resource_type ,
                        ResDBID = resource_database_id ,
                        ObjectName = OBJECT_NAME(resource_associated_entity_id, 
                        resource_database_id) ,
                        
                        RMode = request_mode ,
                        RStatus = request_status
                        FROM sys.dm_tran_locks
                        WHERE resource_type IN ('DATABASE', 'OBJECT');
                        GO
                        
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/_tanz_05.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-5<br /><span>Kontrola na blokowaniem Tabelki
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-5 Kontrola na blokowaniem Tabelki</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        USE AdventureWorks2014;
                        GO
                            ALTER TABLE Person.Address
                            SET ( LOCK_ESCALATION = AUTO );
                            SELECT lock_escalation,lock_escalation_desc
                            FROM sys.tables WHERE name='Address';
                        GO
                        
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide creamB  compact">
        <h2>LOCK_ESCALATION =</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">TABLE :</span> Domyślna.Eskalacja do poziomu tabelki . Całej bezwględu na to czy jest ona partycjonowana</li>
            <li class="next"><span class="green">AUTO :</span> Ustawia eskalacje do poziomu partycji jeżeli tabela jest partycjonowana. Innaczej cała tabelka</li>
            <li class="next"><span class="green">DISABLE :</span> Usuwa eskalacje</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-5 Kontrola na blokowaniem Tabelki</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        USE AdventureWorks2014;
                        GO
                            ALTER TABLE Person.Address
                            SET ( LOCK_ESCALATION = DISABLE);
                            SELECT lock_escalation,lock_escalation_desc
                            FROM sys.tables WHERE name='Address';
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-6<br /><span>Konfiguracja poziomu sesji transakcynej
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>ANSI/ISO SQL definiuje 4 typy interakcji pomiędzy transakcjami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Dirty reads :</span> Następuje gdy transakcje aktualizuje wiersz, a druga transakcja go odczyta zanim pierwsza transakcja się zakończy lub stwierdzi, że chce cofnąć swoją transakcje</li>
            <li class="next"><span class="green">Nonrepeatable reads :</span>Jedna sesja odczytuje dane przed i po UPDATED. Dopóki ta sesja trwa wartość jest taka sama nawet po Commicie Transakcji</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>ANSI/ISO SQL definiuje 4 typy interakcji pomiędzy transakcjami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">Phantom reads :</span> Wykonujemy dwa takie same odczyty. W międzyczasie kasujemy rekord i to sprawia, że dwa odczyty dają różne rezultaty</li>
            <li class="next"><span class="green">Lost updates :</span> Co jeśli mamy dwa polecenia UPDATE? Wygrywa ten który zajdzie później</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 Konfiguracja poziomu sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SET TRANSACTION ISOLATION LEVEL 
                        {   
                            READ UNCOMMITTED 
                            | READ COMMITTED
                            REPEATABLE READ
                            SNAPSHOT | SERIALIZABLE 
                        }
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Isolation Levels</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">READ COMMITTED (domyślny) :</span> Nie potwierdzone dane nie są odczytywane. 

                Insert czy modyfikacje są możliwe na tej tabelce tak długo jak nie operuja one na wierszach z 1 transakcji
            </li>            
            <li class="next">
                Transakcja B może odczytać TYLKO zatwierdzone dane z Transakcji A i może zobaczyć różne wiersze w oparciu o zapis ZATWIERDZONY tylko w B
            </li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 READ COMMITTED</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        session1> NoweOkno;
                        session1> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                        session2> BEGIN Transation
                        session2> UPDATE names SET firstname = 'Bob' WHERE id = 7;
                        session2> SELECT firstname FROM names WHERE id = 7;
                        Bob
                        session1> SELECT firstname FROM names WHERE id = 7;
                        ................
                        session2> COMMIT;
                        session1> Bob
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Isolation Levelsi</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">READ UNCOMMITTED :</span> To najmniej restrekcyjny lock. Użyteczny gdy chcesz skorzystać z transakcji na danych które wiesz, że są operowane tylko przez Ciebie</li>
        <li class="next">Transakcja B może odczytać niezatwierdzone dane z transakcji A i może zobaczyć różne wiersze na podstawie zapisu B. W ogóle nie ma Locka</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 READ UNCOMMITTED</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        session1> Nowe okno
                        session1> SELECT firstname FROM names WHERE id = 7;
                        Aaron

                        session2> BEGIN Transation;
                        session2> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                        session2> UPDATE names SET firstname = 'Bob' WHERE id = 7;
                        session2> SELECT firstname FROM names WHERE id = 7;
                        Bob
                        session1> SELECT firstname FROM names WHERE id = 7;
                        Bob
                        session2> COMMIT;
                        
                        session1> SELECT firstname FROM names WHERE id = 7;
                        Bob
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Isolation Levelsi</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">REPEATABLE READ :</span> 
                Transakcja B odczyta te same dane (wiersze) niezależnie od tego, co robi Transakcja A. Ale transakcja A może zmienić inne wiersze. </li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 REPEATABLE READ</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        session1> Nowe okno
                        session1> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                        
                        session2> BEGIN Transation;
                        session2> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                        session2> UPDATE names SET firstname = 'Bob' WHERE id = 7;
                        session2> SELECT firstname FROM names WHERE id = 7;
                        Bob
                        session2> COMMIT;
                        
                        session1> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Isolation Levelsi</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">SERIALIZABLE :</span> Najbardziej restrykcyjny. Range lock jest umieszczony na podstawie rezutatu wyszukiwania. Kasowanie,Aktualizacje są blokowane</li>
            <li class="next">Transakcja B odczyta te same wiersze, co wcześniej, a transakcja A nie może czytać ani zapisywać w tabeli. Blok na poziomie tabeli</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 SERIALIZABLE</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        session1> BEGIN Transation;
                        session1> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                        
                        session2> BEGIN Transation;
                        session2> SELECT firstname FROM names WHERE id = 7;
                        Aaron
                        session2> UPDATE names SET firstname = 'Bob' WHERE id = 7;
                        session2> ...
                        session2> ...
                        
                        session1> END;
                        session2> UPDATE Done
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>SQL Server Isolation Levels</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">SNAPSHOT :</span> Każda transakcja ma swoją kopie na której może pracować</li>
        </ol>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-6<br /><span>SET TRANSACTION ISOLATION LEVEL SERIALIZABLE
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6 Konfiguracja poziomu sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --pierwsze okno
                        USE AdventureWorks2014;
                        GO
                        SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
                        GO
                            BEGIN TRANSACTION
                            SELECT AddressTypeID, Name
                            FROM Person.AddressType
                            WHERE AddressTypeID BETWEEN 1 AND 6;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6-1 Konfiguracja poziomu sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --drugie okno
                        SELECT resource_associated_entity_id, resource_type,
                        request_mode, request_session_id
                        FROM sys.dm_tran_locks;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6-2 Konfiguracja poziomu sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --TRZECIE okno
                        Update Person.AddressType
                        SET Name = 'T'
                        WHERE AddressTypeID = 1 
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6-3 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --USE AdventureWorks2014;
                        --GO
                        --SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
                        --GO
                        --    BEGIN TRANSACTION
                        --    SELECT AddressTypeID, Name
                        --    FROM Person.AddressType
                        --    WHERE AddressTypeID BETWEEN 1 AND 6;
                        --GO

                        COMMIT TRANSACTION;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-6-5<br /><span>SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6-5 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        USE AdventureWorks2014;
                        GO
                        SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
                        GO
                            BEGIN TRANSACTION
                            SELECT AddressTypeID, Name
                            FROM Person.AddressType
                            WHERE AddressTypeID BETWEEN 1 AND 6;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6-6 Konfiguracja poziomu sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SELECT resource_associated_entity_id, resource_type,
                        request_mode, request_session_id
                        FROM sys.dm_tran_locks;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_17.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6-6 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --USE AdventureWorks2014;
                        --GO
                        --SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
                        --GO
                        --    BEGIN TRANSACTION
                        --    SELECT AddressTypeID, Name
                        --    FROM Person.AddressType
                        --    WHERE AddressTypeID BETWEEN 1 AND 6;
                        --GO

                        COMMIT TRANSACTION;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-6-7<br /><span>SET TRANSACTION ISOLATION LEVEL SNAPSHOT;
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6-7 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        ALTER DATABASE AdventureWorks2014
                        SET ALLOW_SNAPSHOT_ISOLATION ON;
                        GO
                        USE AdventureWorks2014;
                        GO
                        SET TRANSACTION ISOLATION LEVEL SNAPSHOT;
                        GO
                            BEGIN TRANSACTION
                            SELECT CurrencyRateID,EndOfDayRate
                            FROM Sales.CurrencyRate
                            WHERE CurrencyRateID = 8317;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6-8 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        -- w innym oknie 

                        USE AdventureWorks2014;
                        GO
                        UPDATE Sales.CurrencyRate
                        SET EndOfDayRate = 1.00
                        WHERE CurrencyRateID = 8317;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6-9 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        -- w oknie transakcji

                        SELECT CurrencyRateID,EndOfDayRate
                        FROM Sales.CurrencyRate
                        WHERE CurrencyRateID = 8317;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-6-10 Konfiguracja sesji transakcynej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        -- w oknie transakcji

                        COMMIT TRANSACTION;
                        SELECT CurrencyRateID,EndOfDayRate
                        FROM Sales.CurrencyRate
                        WHERE CurrencyRateID = 8317;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-7<br /><span>Szukanie blokady i jej usuwanie
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Blokowanie
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Dlaczego blokowanie może nastąpić</h2>
        <ol class="nonumbers">
            <li class="next">Jeżeli tabelka nie ma indeksów wtedy SQL Server może blokować całą tabelkę</li>
            <li class="next">Aplikacja trzyma transakcje otwartą czekaja na interakcje z użytkownikiem</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Dlaczego blokowanie może nastąpić</h2>
        <ol class="nonumbers">
            <li class="next">Zapytanie ustawia lock na całej tabelce mimo iż operują na kilku rekordach</li>
            <li class="next">Zdarzają transakcje które robią dużą ilość aktualizacji</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-7 Szukanie blokady i jej usuwanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        KILL {SPID | UOW} [WITH STATUSONLY]
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide creamB  compact">
        <h2>KILL Command Arguments</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">SPID :</span> ID Sesji którą chcemy zamknać</li>
            <li class="next"><span class="green">UOW :</span> ID transakcji</li>
            <li class="next"><span class="green">WITH STATUSONLY :</span> Dostaniesz estymacje ile potrwa cofinięce blokującej transakcji</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-7 Szukanie blokady i jej usuwanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --na jednym oknie
                        USE AdventureWorks2014;
                        GO
                        BEGIN TRAN
                        UPDATE Production.ProductInventory
                        SET Quantity = 400
                        WHERE ProductID = 1 AND LocationID = 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-7-2 Szukanie blokady i jej usuwanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w drugim oknie
                        USE AdventureWorks2014;
                        GO
                        BEGIN TRAN
                        UPDATE Production.ProductInventory
                        SET Quantity = 406
                        WHERE ProductID = 1 AND LocationID = 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-7-3 Szukanie blokady i jej usuwanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w trzecim oknie
                        SELECT blocking_session_id, wait_duration_ms, session_id
                        FROM sys.dm_os_waiting_tasks
                        WHERE blocking_session_id IS NOT NULL;
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/trans_02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-7 Szukanie blokady i jej usuowanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w czwartym oknie
                        SELECT t.text
                        FROM sys.dm_exec_connections c
                        CROSS APPLY sys.dm_exec_sql_text (c.most_recent_sql_handle) t
                        WHERE c.session_id = 55; 
                        --użyj blocking_session_id z poprzedniego zapytania
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/trans_03.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-7-4 Szukanie blokady i jej usuowanie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        KILL 55;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-8<br /><span>Konfiguranie tego jak długo wyrażenie może przetrzymać lock, aż do jego wyzwolenia
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-8 Konfiguranie tego jak długo wyrażenie może przetrzymać lock, aż do jego wyzwolenia</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SET LOCK_TIMEOUT timeout_period
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-8 Konfiguranie tego jak długo wyrażenie może przetrzymać lock, aż do jego wyzwolenia</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SET LOCK_TIMEOUT timeout_period
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-8-1 Konfiguranie tego jak długo wyrażenie może przetrzymać lock, aż do jego wyzwolenia</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w pierwszym oknie
                        USE AdventureWorks2014;
                        GO
                        BEGIN TRAN
                        UPDATE Production.ProductInventory
                        SET Quantity = 400
                        WHERE ProductID = 1 AND LocationID = 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-8-2 Konfiguranie tego jak długo wyrażenie może przetrzymać lock, aż do jego wyzwolenia</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w drugim oknie
                        USE AdventureWorks2014;
                        GO
                        SET LOCK_TIMEOUT 5000;
                        UPDATE Production.ProductInventory
                        SET Quantity = 406
                        WHERE ProductID = 1 AND LocationID = 1;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Deadlock
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Jak Deadlock może nastąpić?</h2>
        <ol class="nonumbers">
            <li class="next">Aplikacja sięga do tabelek za każdym razem w innej kolejności. Zakładając, że masz takie dwie sesje to mogą one wzajemnie się zablokować</li>
            <li class="next">Aplikacja ma transakcje które są długie i operują na dużej liczbie rekordów</li>
            <li class="next">Eskalacja na dwóch sesjach spowodowała deadlock</li>
        </ol>
    </section>
    <!-- <section class="slide creamB">
        <span class="shout colors">8-9<br /><span>Szukanie deadlock-u poprzez Trace Flag
        </span></span>
    </section>
    <section class="slide creamB">
        <span class="shout colors"><span>Chociaż w przypadku deadlock-ów bardziej byś skorzystał z "SQL Profiler"
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Trace Flag</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        DBCC TRACEON ( trace# [ ,...n ][ ,-1 ] ) [ WITH NO_INFOMSGS ]
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>DBCC TRACEON Command Arguments</h2>
        <ol class="nonumbers">
            <li class="next">trace# : flaga do śledzenia</li>
            <li class="next">-1 : poziom dostępności flagi</li>
            <li class="next">WITH NO_INFOMSGS : ogranicza informację w DBCC</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Trace Flag</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        DBCC TRACESTATUS ( [ [ trace# [,...n ]][,][ -1 ]]) [ WITH NO_INFOMSGS ]
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>DBCC TRACESTATUS Command Arguments</h2>
        <ol class="nonumbers">
            <li class="next">trace# [,...n ]]: flaga do śledzenia</li>
            <li class="next">-1 : poziom dostępności flagi</li>
            <li class="next">WITH NO_INFOMSGS : ogranicza informację w DBCC</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Trace Flag</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        DBCC TRACEOFF ( trace# [ ,.. .n ] [ , -1 ] ) [ WITH NO_INFOMSGS ]
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>DBCC TRACEOFF Command Arguments</h2>
        <ol class="nonumbers">
            <li class="next">trace# [,...n ]]: flaga do wyłączenia</li>
            <li class="next">-1 : poziom dostępności flagi</li>
            <li class="next">WITH NO_INFOMSGS : ogranicza informację w DBCC</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Trace Flag</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w pierwszym oknie
                        USE AdventureWorks2014;
                        GO
                        SET NOCOUNT ON;
                        WHILE 1=1
                        BEGIN
                        BEGIN TRANSACTION
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 1
                        WHERE BusinessEntityID = 1494;
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 2
                        WHERE BusinessEntityID = 1492;
                        COMMIT TRANSACTION
                        EN
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Trace Flag</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --w pierwszym oknie
                        USE AdventureWorks2014;
                        GO
                        SET NOCOUNT ON;
                        WHILE 1=1
                        BEGIN
                        BEGIN TRANSACTION
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 1
                        WHERE BusinessEntityID = 1494;
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 2
                        WHERE BusinessEntityID = 1492;
                        COMMIT TRANSACTION
                        END
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Trace Flag</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        DBCC TRACEON (1222, -1)
                        GO
                        DBCC TRACESTATUS
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section> -->
    <section class="slide creamB">
        <span class="shout colors">8-9<br /><span>Szukanie deadlock-u poprzez Extended Events
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9 Szukanie deadlock-u poprzez Extended Events</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --pierwsze okno
                        USE AdventureWorks2014;
                        GO
                        SET NOCOUNT ON;
                        SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
                        WHILE 1=1
                        BEGIN
                            BEGIN TRAN
                                UPDATE Purchasing.Vendor
                                SET CreditRating = 1
                                WHERE BusinessEntityID = 1494;
                                UPDATE Purchasing.Vendor
                                SET CreditRating = 2
                                WHERE BusinessEntityID = 1492;
                            COMMIT TRAN
                        END
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9-2 Szukanie deadlock-u poprzez Extended Events</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        --drugie okno
                        USE AdventureWorks2014;
                        GO
                        SET NOCOUNT ON;
                        WHILE 1=1
                        BEGIN
                        BEGIN TRANSACTION
                            UPDATE Purchasing.Vendor
                            SET CreditRating = 2
                            WHERE BusinessEntityID = 1492;
                            UPDATE Purchasing.Vendor
                            SET CreditRating = 1
                            WHERE BusinessEntityID = 1494;
                            COMMIT TRANSACTION
                        END
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9-3 Szukanie deadlock-u poprzez Extended Events</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 22px !important;">
                        --trzecie okno

                        CREATE EVENT SESSION [Deadlock] ON SERVER
                        ADD EVENT sqlserver.lock_deadlock(
                        ACTION(sqlserver.database_name,sqlserver.plan_handle,sqlserver.sql_text)),
                        ADD EVENT sqlserver.xml_deadlock_report
                        ADD TARGET package0.event_file(SET filename=N'D:\Deadlock.xel')

                        --Upewnij się, że masz dostęp i uprawienia do ścieżki

                        WITH (STARTUP_STATE=ON)
                        GO
                        ALTER EVENT SESSION Deadlock
                        ON SERVER
                        STATE = START;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9-4 Szukanie deadlock-u poprzez Extended Events</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 22px !important;">
                        --czwarte okno

                        SELECT TargetData AS DeadlockGraph
                        FROM
                        (SELECT CAST(event_data AS xml) AS TargetData
                        FROM sys.fn_xe_file_target_read_file
                        ('D:\Deadlock*.xel',NULL,NULL, NULL)
                        )
                        AS Data
                        WHERE 
                        TargetData.value('(event/@name)[1]', 'varchar(50)') = 'xml_deadlock_report';
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9-3 Szukanie deadlock-u poprzez Extended Events</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 16px;overflow: hidden;  " class="language-xml">
                    <code style="line-height: 16px !important;">

                        &#x3C;event name=&#x22;xml_deadlock_report&#x22; package=&#x22;sqlserver&#x22; timestamp=&#x22;2020-11-17T12:16:37.572Z&#x22;&#x3E;
                        &#x3C;data name=&#x22;xml_report&#x22;&#x3E;
                          &#x3C;value&#x3E;
                            &#x3C;deadlock&#x3E;
                              &#x3C;victim-list&#x3E;
                                &#x3C;victimProcess id=&#x22;process177af683088&#x22; /&#x3E;
                              &#x3C;/victim-list&#x3E;
                              &#x3C;process-list&#x3E;
                                &#x3C;process id=&#x22;process177af683088&#x22; taskpriority=&#x22;0&#x22; 
                                logused=&#x22;144&#x22; waitresource=&#x22;KEY: 5:72057594049789952 (b4903b2250cc)&#x22; 
                                waittime=&#x22;3521&#x22; ownerId=&#x22;468635&#x22; transactionname=&#x22;user_transaction&#x22; 
                                lasttranstarted=&#x22;2020-11-17T13:16:34.050&#x22; XDES=&#x22;0x1779f36c428&#x22; 
                                lockMode=&#x22;X&#x22; schedulerid=&#x22;7&#x22; kpid=&#x22;20452&#x22; 
                                status=&#x22;suspended&#x22; spid=&#x22;56&#x22; sbid=&#x22;0&#x22; ecid=&#x22;0&#x22; 
                                priority=&#x22;0&#x22; trancount=&#x22;2&#x22; lastbatchstarted=&#x22;2020-11-17T13:16:34.050&#x22; 
                                lastbatchcompleted=&#x22;2020-11-17T13:16:34.047&#x22; lastattention=&#x22;1900-01-01T00:00:00.047&#x22; 
                                clientapp=&#x22;Microsoft SQL Server Management Studio - Query&#x22; hostname=&#x22;CEZMSI&#x22; 
                                hostpid=&#x22;1476&#x22; loginname=&#x22;CEZMSI\PanNiebieski&#x22; 
                                isolationlevel=&#x22;read committed (2)&#x22; xactid=&#x22;468635&#x22; currentdb=&#x22;5&#x22; 
                                currentdbname=&#x22;AdventureWorks2014&#x22; lockTimeout=&#x22;4294967295&#x22; 
                                clientoption1=&#x22;673187936&#x22; clientoption2=&#x22;390200&#x22;&#x3E;
                                  &#x3C;executionStack&#x3E;
                                    &#x3C;frame procname=&#x22;adhoc&#x22; line=&#x22;8&#x22; stmtstart=&#x22;40&#x22; stmtend=&#x22;200&#x22; 
                                    sqlhandle=&#x22;0x02000000eac1af36f412db4e21d9dcc86feb261fa6bcd2300000000000000000000000000000000000000000&#x22;&#x3E;
                      unknown    &#x3C;/frame&#x3E;
                                    &#x3C;frame procname=&#x22;adhoc&#x22; line=&#x22;8&#x22; stmtstart=&#x22;300&#x22; 
                                    stmtend=&#x22;468&#x22; sqlhandle=&#x22;0x020000005312e433857f0fc42c7763c9f49c0ba8feeff51d0000000000000000000000000000000000000000&#x22;&#x3E;
                      unknown    &#x3C;/frame&#x3E;
                                  &#x3C;/executionStack&#x3E;
                                  &#x3C;inputbuf&#x3E;

                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-9-3 Szukanie deadlock-u poprzez Extended Events</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 16px;overflow: hidden;  " class="language-xml">
                    <code style="line-height: 16px !important;">
                        
                        &#x3C;resource-list&#x3E;
                        &#x3C;keylock hobtid=&#x22;72057594049789952&#x22; dbid=&#x22;5&#x22; objectname=&#x22;AdventureWorks2014.Purchasing.Vendor&#x22; indexname=&#x22;PK_Vendor_BusinessEntityID&#x22; id=&#x22;lock177a9200900&#x22; mode=&#x22;X&#x22; associatedObjectId=&#x22;72057594049789952&#x22;&#x3E;
                          &#x3C;owner-list&#x3E;
                            &#x3C;owner id=&#x22;process1779d5c88c8&#x22; mode=&#x22;X&#x22; /&#x3E;
                          &#x3C;/owner-list&#x3E;
                          &#x3C;waiter-list&#x3E;
                            &#x3C;waiter id=&#x22;process177af683088&#x22; mode=&#x22;X&#x22; requestType=&#x22;wait&#x22; /&#x3E;
                          &#x3C;/waiter-list&#x3E;
                        &#x3C;/keylock&#x3E;
                        &#x3C;keylock hobtid=&#x22;72057594049789952&#x22; dbid=&#x22;5&#x22; objectname=&#x22;AdventureWorks2014.Purchasing.Vendor&#x22; indexname=&#x22;PK_Vendor_BusinessEntityID&#x22; id=&#x22;lock177a9200b80&#x22; mode=&#x22;X&#x22; associatedObjectId=&#x22;72057594049789952&#x22;&#x3E;
                          &#x3C;owner-list&#x3E;
                            &#x3C;owner id=&#x22;process177af683088&#x22; mode=&#x22;X&#x22; /&#x3E;
                          &#x3C;/owner-list&#x3E;
                          &#x3C;waiter-list&#x3E;
                            &#x3C;waiter id=&#x22;process1779d5c88c8&#x22; mode=&#x22;X&#x22; requestType=&#x22;wait&#x22; /&#x3E;
                          &#x3C;/waiter-list&#x3E;
                        &#x3C;/keylock&#x3E;
                      &#x3C;/resource-list&#x3E;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/f_16.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">8-10<br /><span>Ustawienie priorytet do Deadlock
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-10 Ustawienie priorytet do Deadlock</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SET DEADLOCK_PRIORITY { LOW | NORMAL | HIGH | <numeric-priority> }
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-10 Ustawienie priorytet do Deadlock</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SET DEADLOCK_PRIORITY { LOW | NORMAL | HIGH | [numeric-priority] }
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide creamB  compact">
        <h2>SET DEADLOCK_PRIORITY Command Arguments</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">LOW :</span> Ustawiasz obecne połączenie jako niski powód do deadlock-ui>
            <li class="next"><span class="green">NORMAL :</span> SQL Server oceni które połączenie trzeba cofnąć</li>
            <li class="next"><span class="green">HIGH :</span> Ustawiasz wysokie ryzko deadlock-u chyba, że inne połączenie też jest HIGH</li>
            <li class="next"><span class="green">[numeric-priority] :</span> Twoja liczba od -10 do 10</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>SET DEADLOCK_PRIORITY Command Arguments</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">[numeric-priority] :</span> Twoja liczba od -10 do 10</li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">8-10 Ustawienie priorytet do Deadlock</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">

                        USE AdventureWorks2014;
                        GO
                        SET NOCOUNT ON;
                        SET DEADLOCK_PRIORITY LOW;

                        WHILE 1=1
                        BEGIN
                        BEGIN TRANSACTION
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 1
                        WHERE BusinessEntityID = 1492;
                        UPDATE Purchasing.Vendor
                        SET CreditRating = 2
                        WHERE BusinessEntityID = 1494;
                        COMMIT TRANSACTION
                        END
                        GO
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>

    <section class="slide creamB">
        <span class="shout colors"><span>9. Pracowanie ze stringami
        </span></span>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">CONCAT :</span> Łączy napisy</li>
            <li class="next"><span class="green">ASCII and CHAR :</span> ASCII bierze znak najbardziej po lewej i zwraca kod ASCII. CHAR konwertuje liczbę ASCII na znak</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">CHARINDEX and PATINDEX :</span> CHARINDEX zwraca indeks początku jednego napisu w drugim. PATINDEX działa podobnie, ale możesz użyć wild card</li>
            <li class="next"><span class="green">DIFFERENCE and SOUNDEX :</span> Sprawdzenie czy napisy są róźne i czy brzmią tak samo</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">FORMAT :</span> MOdyfikuje DATE/TIME na string</li>
            <li class="next"><span class="green">LEFT and RIGHT :</span> Zwraca część napisu zaczynając od liczby znaków od lewej</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">LEN and DATALENGTH :</span> LEN zwraca liczbę znaków w napisie pomijając białe znaki po ostatnim zanku. DATALENGHT zwraca liczbę bajtów użytych. </li>
            <li class="next"><span class="green">LOWER and UPPER :</span> Zmiana wielości napisu</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">LTRIM and RTRIM :</span> Usuwa białe znaki</li>
            <li class="next"><span class="green">NCHAR and UNICODE :</span> UNICODE zwraca liczbę całkowitą dla pierwszego znaku. NCHAR przyjmmuje liczbę całkowitą UNICODE i zwarca znak</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">QUOTENAME :</span> Zwraca UNICODE i dodadaje delimiter aby był to okej dla SQL Server</li>
            <li class="next"><span class="green">REPLACE :</span> Zastępuje jeden napis drugim</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">REPLICATE :</span> Powtarza dany znak wiele razy</li>
            <li class="next"><span class="green">REVERSE :</span> Odwraca kolejność napisu</li>

        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">

            <li class="next"><span class="green">SPACE :</span> Zna liczbę znaków spacji tyle ile razy chcesz</li>
            <li class="next"><span class="green">STR :</span> Zmienia numeryczną dane na string</li>
        </ol>
    </section>
    <section class="slide creamB  compact">
        <h2>Pracowanie ze stringami</h2>
        <ol class="nonumbers">
            <li class="next"><span class="green">STUFF :</span> Kasuje w określonym miejscu teskt i wstawia nowy</li>
            <li class="next"><span class="green">SUBSTRING :</span> Zwraca część napisu</li>
        </ol>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-1<br /><span>Łączenie napisów
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-1 Łączenie napisów</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 35px !important;">
                        SELECT TOP (15)
                        FullName = 
                        CONCAT(LastName, ', ', FirstName, ' ', MiddleName)
                        FROM Person.Person p;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_01.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-2<br /><span>Znajdź wartość ASCII
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-2 Znajdź wartość ASCII</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SELECT ASCII('c'),
                        ASCII('e'),
                        ASCII('z'),
                        ASCII('a'),
                        ASCII('r');

                        SELECT CHAR(99),
                        CHAR(101),
                        CHAR(122),
                        CHAR(97),
                        CHAR(114) ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_02.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-3<br /><span>Znajdź wartość cyfrową kodu UNICODE
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-3 Znajdź wartość cyfrową kodu UNICODE</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 28px !important;">
                        SELECT UNICODE('G'),
                        UNICODE('o'),
                        UNICODE('o'),
                        UNICODE('d'),
                        UNICODE('!');

                        SELECT NCHAR(71),
                        NCHAR(111),
                        NCHAR(111),
                        NCHAR(100),
                        NCHAR(33) ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_03.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-4<br /><span>Lokalizowanie znaków w stringu
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-4 Lokalizowanie znaków w stringu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 35px !important;">
                        SELECT CHARINDEX('string to find',
                        'Znajdź mi "string to find" w tym napisie');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_04.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-4 Lokalizowanie znaków w stringu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 35px !important;">
                        SELECT TOP 18
                        AddressID,
                        AddressLine1,
                        PATINDEX('%[0]%Mt%', AddressLine1)
                        FROM Person.Address
                        WHERE PATINDEX('%[0]%Mt%', AddressLine1) > 0;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_05.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-5<br /><span>Porównywanie napisów
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-5 Porównywanie napisów</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 35px !important;">
                        SELECT DISTINCT
                        SOUNDEX(LastName),
                        SOUNDEX('Smi'),
                        LastName
                        FROM Person.Person
                        WHERE SOUNDEX(LastName) = SOUNDEX('Smi');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_06.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-6<br /><span>Zwracanie napisów po lewej i po prawej
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-6 Zwracanie napisów po lewej i po prawej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT LEFT('Chce tylko 10 znaków po lewej', 10);

                        SELECT RIGHT('Chce tylko 10 znaków po prawej', 10);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_07.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-6-1 Zwracanie napisów po lewej i po prawej</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">
                        SELECT TOP (18)
                        ProductNumber,
                        ProductName = LEFT(Name, 10),
						ProductName = RIGHT(Name, 10)
                        FROM Production.Product;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">

                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_08.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-7<br /><span>Zwracanie tylko części napisu
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-7 Zwracanie tylko części napisu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT TOP (18)
                        PhoneNumber,
                        AreaCode = LEFT(PhoneNumber, 3),
                        Exchange = SUBSTRING(PhoneNumber, 5, 3)
                        FROM Person.PersonPhone
                        WHERE PhoneNumber LIKE 
                        '[0-9][0-9][0-9]-[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]';
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_09.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-8<br /><span>Liczenie długości napisu
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-8 Liczenie długości napisu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT LEN(N'SQL został opracowany w latach 70. w firmie IBM. 
						Stał się standardem w komunikacji z 
						serwerami relacyjnych baz danych.');

                        SELECT DATALENGTH(N'SQL został opracowany w latach 70. w firmie IBM. 
						Stał się standardem w komunikacji z serwerami relacyjnych baz danych.');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_010.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-8-1 Liczenie długości napisu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">
                        SELECT
                        DATALENGTH(123) as [123],
                        DATALENGTH(123.0) as [123.0],
						DATALENGTH('123') as ['123'],
                        DATALENGTH(GETDATE()) as [GetDate];
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_11.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-9<br /><span>Zastąpienie części napisu
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-9 Zastąpienie części napisu</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT REPLACE('Pierwszą firmą, która włączyła SQL
                        do swojego produktu komercyjnego, był Oracle.'
                        , 'Oracle', 'Lichy Dzwig');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_12.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-10<br /><span>Umieść napis w X
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-10 Umieść napis w X</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT STUFF ( 'Mój kot ma na imię X. Poznałeś go?', 18, 1, 'Stefan' );
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_13.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-11<br /><span>Zmiana wielkości znaków
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-11 Zmiana wielkości znaków</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 30px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 30px !important;">
                        SELECT LOWER(DocumentSummary)
                        FROM Production.Document
                        WHERE FileName = 'Installing Replacement Pedals.doc';

                        SELECT UPPER(DocumentSummary)
                        FROM Production.Document
                        WHERE FileName = 'Installing Replacement Pedals.doc';
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_14.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-12<br /><span>Usuwanie i dodawanie białych znaków
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-12 Usuwanie i dodawanie białych znaków</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        SELECT CONCAT('||', 
						LTRIM('         Napis       '), 
                        '||' );

                        SELECT CONCAT('||', 
						RTRIM('         Napis       '),
                         '||' );
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_15.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-13<br /><span>Potwórz znaki wiele razy
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-13 Potwórz znaki wiele razy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">
                        SELECT REPLICATE ('W', 30) ;
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_16.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-14<br /><span>Potwórz białe znaki wiele razy
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-14 Potwórz białe znaki wiele razy</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 25px !important;">
                        DECLARE @animals TABLE
                        (
							string1 VARCHAR(20),
							string2 VARCHAR(20),
							string3 VARCHAR(20)
                        );

                        INSERT @animals
                        VALUES ('elephant', 'dog', 'giraffe'),
                        ('kitty', 'puppy', 'ant'),
                        ('chicken', 'fish', 'marmacet');

                        SELECT CONCAT(string1, SPACE(40 - LEN(string1)),
                        string2, SPACE(40 - LEN(string2)),
                        string3, SPACE(40 - LEN(string3))) AS a
                        FROM @animals
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_17.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamB">
        <span class="shout colors">9-15<br /><span>Odwrócenie kolejności znaków
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle"> 
                <h2 class="headerCODE">9-15 Odwrócenie kolejności znaków</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 45px;overflow: hidden;  " class="language-sql">
                    <code style="line-height: 45px !important;">
                        SELECT REVERSE('Jak Programowac');
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/S_18.PNG" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    
  



    <section class="slide creamG">
        <span class="shout colors"><span>Podsumowanie
        </span></span>
    </section>
    <section class="slide creamG">
        <span class="shout colors"><span>Dzięki za obecność
        </span></span>
    </section>
    <!-- <div class="progress"></div> -->
    <footer class="badge badge-top-left">
        <a href="#" class="fullscreen">Fullscreen</a>
    </footer>

    <script src="vendors/gamepad/gamepad.js"></script>
    <script src="vendors/shower/shower.min.js"></script>
    <script src="vendors/shower-gamepad/shower.gamepad.js"></script>

    <!-- Prism.js -->
    <script src="vendors/prism/prism.js"></script>
    <script src="vendors/prism/custom-prism.js"></script>

</body>

</html>